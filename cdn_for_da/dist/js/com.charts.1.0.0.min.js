var comCharts=function(){function a(a){console.error("%c[Error - TimeSeries] ","color: red;font-weight:bold;font-size:14px",a)}function b(a){console.warn("%c[Warning - TimeSeries] ","color: #F8C325;font-weight:bold;font-size:14px",a)}function c(a,b,c){return a[b]===c}function d(a,c){for(var d=!1,e=f.validation.dataTypes,g="",h=a[c],i=0,j=0,k=h.length;k>j;j++)e(h[j],"string")||(d=!0,i&&(g+=", "),g+=h[j],h[j]="grey",i++);return d&&b(f.errors.invalidConfig(c,a.selector)+g+" are not valid colors"),h}function e(b,c){var d,e=b.dateColumnName,g=b.metricsColumnName,h=!0,i="",j="",k=[],l=[];e in c||(d=f.errors.invalidColumnName(b.selector,"dateColumnName",e),a(d),h=!1);for(var m=0,n=g.length;n>m;m++)"string"==typeof g[m]?g[m]in c?(k.push(g[m].replace(/[\(\)\!\@\#\$\%\^\&\*\+\=\[\]\{\}\;\'\:\"\|, \.]*/gi,"")),l.push(g[m])):(i+=j+g[m],h=!1):g[m].metric in c&&g[m].seriesColumnName in c?(k.push(g[m].metric.replace(/[\(\)\!\@\#\$\%\^\&\*\+\=\[\]\{\}\;\'\:\"\|, \.]*/gi,"")+"_"+g[m].seriesName.replace(/[\(\)\!\@\#\$\%\^\&\*\+\=\[\]\{\}\;\'\:\"\|, \.]*/gi,"")),l.push(g[m].metric+" - "+g[m].seriesName)):(i+=j+g[m].metric+" or "+g[m].seriesColumnName,h=!1),j=", ";return i&&(d=f.errors.invalidColumnName(b.selector,"metricsColumnName",i),a(d)),f.chart_options[b.selector].newMetricsColumn=[],f.chart_options[b.selector].newMetricsColumn=k,f.chart_options[b.selector].displayMetricsColumn=[],f.chart_options[b.selector].displayMetricsColumn=l,h}var f={};f.configJSON=[],f.default_config={},f.query_data={},f.chart_configs={},f.chart_options={},f.chart_status={},f.featuresOnChart={},f.chart_to_filter_mapping={},f["default"]={},f["default"].chart_config={},f.errors={},f.allCharts=[],f.featureToChartMapping={},f.chartToFeatureMapping={},f.assets=f.assets||"/",f.global_data_sets={},f.data_aliases={},f.gData_set_to_chart_mapping={},f.gChart_to_data_set_mapping={},f.data_load_status={},f.modalStatus={},f.Query=function(){var a=function(a,b,c){var d=f.query_data[a];f.query_data[a].custom_internal_dimension_||(f.query_data[a].custom_internal_dimension_=d.cf.dimension(function(a){return"a"})),f.query_data[a][b+"_dimension_"]=d.cf.dimension(function(a){for(var b,d,e,f="",g="|+|",h=c.length,i=0;h>i;i++)0===i&&(g=""),"object"==typeof c[i]?(e=Object.keys(c[i])[0],d=c[i][e]):d=c[i],b="function"==typeof d?e:d,"function"==typeof d?f=d(a):""===g&&1===h?f=a[d]:f+=a[d]+g;return f})},b=function(b,c,d){f.query_data[b][c].query_config.metric||(f.query_data[b][c].query_config.metric=d.metric,d=d.metric);for(var e=f.query_data[b],g=d.length,h=0;g>h;h++){var i=Object.keys(d[h])[0];e.hasOwnProperty(c+"_dimension_")||a(b,c,[i]);var j,k=i,l=d[h][i];j=j?"1e-"+j:"1e-2";var m=function(a){return"function"==typeof l?l(a):+a[k]},n=function(a,b){var c=isNaN(+b[k])?0:+b[k];switch(l){case"count":return a+1;case"sum":return a+=parseFloat(c),+j>a&&(a=0),a;case"min":return"a"===a&&(a=+c),a=+c>a?a:+c;case"max":return"a"===a&&(a=+c),a=a>+c?a:+c;case"median":a.arr.push(+c),a.arr.sort(function(a,b){return a-b});var d=Math.floor(a.arr.length/2);return a.arr.length%2?(a.val=a.arr[d],a):(a.val=(a.arr[d-1]+a.arr[d])/2,a);case"avg":return++a.count,a.sum+=+c,a.val=a.sum/a.count,a.sum<=0&&(a.val=0),a;case"value":return a.val=c,a;case"std":a.arr.push(+c),++a.count,a.sum+=+c,a.mean=a.sum/a.count;for(var e=0,f=0;f<a.count;f++)e+=Math.pow(a.arr[f]-a.mean,2);return a.variance=e/a.count,a.std=Math.sqrt(a.variance),a;default:return m(b)}},o=function(a,b){var c=isNaN(+b[k])?0:+b[k];switch(l){case"count":return a-1;case"sum":return a-=parseFloat(c),+j>a&&(a=0),a;case"min":return"a"===a&&(a=+c),a=+c>a?a:+c;case"max":return"a"===a&&(a=+c),a=a>+c?a:+c;case"mean":break;case"median":a.arr.push(+c),a.arr.sort(function(a,b){return a-b});var d=Math.floor(a.arr.length/2);return a.arr.length%2?(a.val=a.arr[d],a):(a.val=(a.arr[d-1]+a.arr[d])/2,a);case"avg":return a.sum-=+c,--a.count,a.val=a.sum/a.count,a.sum<=0&&(a.val=0),a;case"value":return a.val=c,a;case"std":a.arr.push(+c),++a.count,a.sum-=+c,a.mean=a.sum/a.count;for(var e=0,f=0;f<a.count;f++)e+=Math.pow(a.arr[f]-a.mean,2);return a.variance=e*a.count,a.std=Math.sqrt(a.variance),a;default:return m(b)}},p=function(){switch(l){case"count":return 0;case"sum":return 0;case"min":return"a";case"max":return"a";case"mean":break;case"median":return{val:0,arr:[]};case"avg":return{count:0,sum:0,val:0};case"value":return{val:0};case"std":return{mean:0,variance:0,deviation:0,sum:0,count:0,arr:[]};default:return 0}};e[c].query_config.dimension?f.query_data[b][c+"_metric_"]=e[c+"_dimension_"].group().reduce(n,o,p):f.query_data[b][c+"_metric_"]=e.custom_internal_dimension_.group().reduce(n,o,p)}},c=function(b,c,d){var e,g=f.query_data[b];e="object"==typeof g[c].query_config.dimension[0]?Object.keys(g[c].query_config.dimension[0])[0]:g[c].query_config.dimension[0];for(var h=0;h<d.length;h++){var i,j=d[h].column,k=d[h].condition,l=d[h].values;switch(k){case"Equal":i=function(a){return a===l};break;case"NotEqual":i=function(a){return a!==l};break;case"LessThan":i=function(a){return l>a};break;case"GreaterThan":i=function(a){return a>l};break;case"LessThanEqual":i=function(a){return l>=a};break;case"GreaterThanEqual":i=function(a){return a>=l};break;case"Between":i=function(a){return a>=l[0]&&a<=l[1]};break;case"NotBetween":i=function(a){return a<l[0]&&a>l[1]};break;case"In":i=function(a){return-1!==l.indexOf(a)};break;case"NotIn":i=function(a){return-1===l.indexOf(a)};break;case"IsNull":i=function(a){return void 0===a||null===a};break;case"IsNotNull":i=function(a){return void 0!==a&&null!==a};break;case"Eval":i=l}1===g[c].query_config.dimension.length&&e===j?f.query_data[b][c+"_dimension_"].filter(i):(a(b,j,[j]),f.query_data[b][j+"_dimension_"].filter(i))}},d=function(a,b,c,d){var e=f.query_data[a][b].query_config;e.filter_impacts&&delete e.filter_impacts,e.data_impacts&&delete e.data_impacts,g(c,b,e);var h={};h[c]=d,f.query_data[a][b].query_config.filter_impacts?f.query_data[a][b].query_config.filter_impacts.push(h):f.query_data[a][b].query_config.filter_impacts=[h]},e=function(a,b,c,d){var e,h,i=f.query_data[a][b].query_config.data_impacts;for(e=0;e<i.length&&i[e]!==a;e++){var k=i[e],l=Object.keys(f.query_data[k]);for(h=0;h<l.length;h++)l[h].match("_dimension_")?(f.query_data[k][l[h]].filterAll(),f.query_data[k][l[h]].dispose(),delete f.query_data[k][l[h]]):l[h].match("_metric_")&&(f.query_data[k][l[h]].dispose(),delete f.query_data[k][l[h]]);for(f.query_data[k].cf.remove(),f.query_data[k].cf.add(c),l=Object.keys(f.query_data[k]),h=0;h<l.length;h++)if("cf"!==l[h]&&!l[h].match("_dimension_")&&!l[h].match("_metric_")&&(g(k,l[h],f.query_data[k][l[h]].query_config),f.query_data[k][l[h]].query_config.data_impacts)){j(k,l[h])}}},g=function(e,g,h){var i;if(f.query_data[e][g]={query_config:h},f.query_data[e][g].query_config.dimension&&a(e,g,f.query_data[e][g].query_config.dimension),f.query_data[e][g].query_config.metric&&b(e,g,f.query_data[e][g].query_config.metric),f.query_data[e][g].query_config.filter&&c(e,g,f.query_data[e][g].query_config.filter),f.query_data[e][g].query_config.filter_impacted_by){var j=f.query_data[e][g].query_config.filter_impacted_by;for(i=0;i<j.length;i++)d(Object.keys(j[i])[0],j[i][Object.keys(j[i])[0]],e,g)}if(f.query_data[e][g].query_config.data_impacted_by){var k=f.query_data[e][g].query_config.data_impacted_by;for(i=0;i<k.length;i++){var l=Object.keys(k[i])[0],m=k[i][l];if(f.query_data[l][m].query_config.data_impacts){if(-1!==f.query_data[l][m].query_config.data_impacts.indexOf(e))continue;f.query_data[l][m].query_config.data_impacts.push(e)}else f.query_data[l][m].query_config.data_impacts=[e]}}if(f.query_data[e][g].query_config.data_impacts)if(f.query_data[e][g].query_config.data_impacts){var n=h.data_impacts,o=n.length;for(i=0;o>i;i++)-1===f.query_data[e][g].query_config.data_impacts.indexOf(n[i])&&f.query_data[e][g].query_config.data_impacts.push(n[i])}else f.query_data[e][g].query_config.data_impacts=h.data_impacts},h=function(a,b,d){f.query_data[a][b].query_config.filter?f.query_data[a][b].query_config.filter.push.apply(f.query_data[a][b].query_config.filter,d):f.query_data[a][b].query_config.filter=d,c(a,b,d);var e=f.query_data[a][b].query_config.filter_impacts;if(e)for(var g=0;g<e.length;g++){var i=Object.keys(e[g])[0];if(i===a)break;h(i,b,d)}},i=function(a,b,c){var d,e,g,h=f.query_data[a][b].query_config.filter_impacts,j=f.query_data[a][b].query_config.filter;for(j&&(g=j.length),f.query_data[a][b+"_dimension_"]&&f.query_data[a][b+"_dimension_"].filterAll(),d=0;d<c.length;d++)for(f.query_data[a][c[d].column+"_dimension_"]&&f.query_data[a][c[d].column+"_dimension_"].filterAll(),e=0;g>e;e++)c[d].condition||c[d].values||j[e]||j[e].column===c[d].column&&(f.query_data[a][b].query_config.filter.splice(e,1),j.splice(e,1),e--);if(h)for(d=0;d<h.length;d++){var k=Object.keys(h[d])[0];if(k===a)break;i(k,b,c)}},j=function(a,b,c){var d,g,h,i,j,l,m,n={};try{c||(c={}),c.sort&&(g=Object.keys(c.sort)[0],h=c.sort[g])}catch(o){console.error("Sort syntax is not proper")}if(!f.query_data[a][b])return!1;f.query_data[a][b].query_config.metric?(i=c.metric,n=f.query_data[a][b].query_config.metric[0],l=Object.keys(f.query_data[a][b].query_config.metric[0])[0],d=b+"_metric_"):f.query_data[a][b].query_config.dimension?(i=c.dimension,d=b+"_dimension_"):d=b+"_dimension_";try{j="asc"==g&&"dataquerykey"==h?f.query_data[a][d].all():"asc"==g&&"dataqueryvalue"==h?f.query_data[a][d].top(1/0,"asc"):"desc"==g&&"dataquerykey"==h?f.query_data[a][d].all("desc"):"desc"==g&&"dataqueryvalue"==h?f.query_data[a][d].top(1/0):f.query_data[a][d].top(1/0,"asc")}catch(o){console.error("Metric ,Dimension is not created or exist")}var p,q=j.length;if("avg"==n[l])for(dataset=JSON.parse(JSON.stringify(j)),p=0;q>p;p++){var r=dataset[p].value.val;dataset[p].value=r}else dataset=JSON.parse(JSON.stringify(j));if(c.filter){var s,t,u,v;if(c.filter instanceof Array)for(p=0;p<c.filter.length;p++)s=c.filter[p],t=s.condition,u=s.column,v=s.values,dataset=dataset.filter(k(t,u,v));else s=c.filter,t=s.condition,u=s.column,v=s.values,dataset=dataset.filter(k(t,u,v))}return c.bottom&&"number"==typeof c.bottom?m=dataset.slice(dataset.length-c.bottom<0?0:dataset.length-c.bottom,dataset.length):c.top&&"number"==typeof c.bottom&&(m=dataset.slice(0,c.top>dataset.length?dataset.length:c.top)),c.propagateData!==!1&&f.query_data[a][b].query_config.data_impacts&&e(a,b,m?m:dataset),m?m:dataset},k=function(a,b,c){switch(a){case"Equal":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:"object"==typeof a[b]?a[b].val===c:a[b]===c};break;case"NotEqual":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:a[b]!==c};break;case"LessThan":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:a[b]<c};break;case"GreaterThan":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:a[b]>c};break;case"LessThanEqual":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:a[b]<=c};break;case"GreaterThanEqual":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:a[b]>=c};break;case"Between":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:a[b]>=c[0]&&a[b]<=c[1]};break;case"NotBetween":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:a[b]<c[0]&&a[b]>c[1]};break;case"In":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:-1!==c.indexOf(a[b])};break;case"NotIn":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:-1===c.indexOf(a[b])};break;case"IsNull":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:void 0===a[b]||null===a[b]};break;case"IsNotNull":filter_function=function(a){return(""+a.key).indexOf("||")>0?(""+a.key).split("||").indexOf(c)>-1?(a.key=+a.key.split("||")[0],!0):!1:void 0!==a[b]&&null!==a[b]};break;case"Eval":filter_function=c}return filter_function},l=function(a,b){return f.query_data[a]={cf:crossfilter(b)},!0},m=function(a,b,c,d){if("all"===c){for(var e=Object.keys(f.query_data[a]),g=0;g<e.length;g++)e[g].match("_dimension_")&&f.query_data[a][e[g]].filterAll();f.query_data[a].cf.remove(),f.query_data[a].cf.add(b)}else f.addFilter(a,"query",[{column:"x",condition:"Between",values:d}]),f.query_data[a].cf.remove(),f.removeFilter(a,"query",[{column:"x",condition:"Between",values:d}]),f.query_data[a].cf.add(b)},n=function(a,b){try{f.query_data[a]?(f.query_data[a][b]&&delete f.query_data[a][b],f.query_data[a][b+"_dimension_"]&&(f.query_data[a][b+"_dimension_"].remove(),f.query_data[a][b+"_dimension_"].dispose(),delete f.query_data[a][b+"_dimension_"]),f.query_data[a][b+"_metric_"]&&(f.query_data[a][b+"_metric_"].remove(),f.query_data[a][b+"_metric_"].dispose(),delete f.query_data[a][b+"_metric_"])):console.error("Table Name "+a+" does not Exist")}catch(c){console.error("Error in Table name or query name")}};return{init:l,setQuery:g,addFilter:h,removeFilter:i,getData:j,updateData:m,deleteQuery:n,createMetric:b}}(),f.mediator=function(){var a=function(a,b){return f.mediator.channels[a]||(f.mediator.channels[a]={}),f.mediator.channels[a]={context:this,callback:b},this},b=function(a){if(!f.mediator.channels[a])return!1;var b=Array.prototype.slice.call(arguments,1),c=f.mediator.channels[a];return c.callback.apply(c.context,b)},c=function(a){if(a&&0!==a.length){var b,c,d,e,g,h=a.length;for(g=0;h>g;g++)d=a[g].function_name,b=f.mediator.channels[d].callback,e=f.mediator.channels[d].context,c=a[g].attribute,b.apply(e,c)}},d=function(a){delete f.mediator.channels[a]};return{channels:{},publish:b,subscribe:a,unsubscribe:d,publishToAll:c}}(),f.validation=function(){var a=function(a){var b=0===a.length||!a.trim();return b},b=function(a,b){switch(b){case"number":return!isNaN(parseFloat(a))&&isFinite(a);case"array":return a.constructor===Array;case"boolean":return a.constructor===Boolean;case"string":return a.constructor===String;case"object":return a.constructor===Object;case"function":return a.constructor===Function;case"date":return"Invalid Date"!=new Date(a)}},c=function(a,b){return-1!==b.indexOf(a)},d=function(a,c){var d=!0;return c.number&&(d=d&&b(a,"number")),c.between&&(d=d&&a>=c.between[0]&&a<=c.between[1]),c.decimalPlaces>=0&&(d=d&&(a.toString().split(".")[1]||[]).length<=2),d};return{isEmpty:a,dataTypes:b,specificValues:c,betweenValues:d}}(),Array.prototype.unique=function(){if(0===this.length)return[];this.sort();for(var a=[this[0]],b=this.length,c=1;b>c;c++)this[c]!==a[a.length-1]&&a.push(this[c]);return a},Array.prototype.areAllValuesSame=function(){for(var a=this.length,b=1;a>b;b++)if(this[b]!==this[0])return!1;return!0},Array.prototype.equals=function(a){if(!a)return!1;if(this.length!=a.length)return!1;for(var b=0,c=this.length;c>b;b++)if(this[b]instanceof Array&&a[b]instanceof Array){if(!this[b].equals(a[b]))return!1}else if(this[b]!=a[b])return!1;return!0},d3.interpolators.push(function(a,b){function c(a,b){return d3.range(b).map(function(){return a})}function d(a){return a.substr(1,a.length-(h?2:1)).split("L")}function e(a){return"M"+a.join("L")+(h?"Z":"")}function f(a,b){var d=b.length-a.length;return h?c(a[0],d/2).concat(a,c(a[a.length-1],d/2)):c(a[0],d).concat(a)}var g,h,i,j,k,l,m;return g=/M-?\d*\.?\d*,-?\d*\.?\d*(L-?\d*\.?\d*,-?\d*\.?\d*)*Z?/,g.test(a)&&g.test(b)?(h="Z"===a[a.length-1],j=d(a),k=d(b),l=j.length,m=k.length,l>m&&(k=f(k,j)),m>l&&(j=f(j,k)),i=d3.interpolateString(m>l?e(j):a,l>m?e(k):b),m>l?i:function(a){return 1===a?b:i(a)}):void 0});var g=function(a){return document.getElementById(a)?!0:!1},h=function(a){return a=a.trim(),a=a.substr(0,1).toUpperCase()+a.substr(1)};f.errors=function(){var a=function(a,b){return"For Chart Selector '"+b+"' : The element with the id '"+a+"' does not exist on DOM."},b=function(a,b){return"For Chart Selector '"+b+"' : The element with the id '"+a+"' already exist on DOM."},c=function(a,b){return"For Chart Selector '"+b+"' : The element with the id '"+a+"' does not exist."},d=function(a,b){return"For Chart Selector '"+b+"' : '"+a+"' already exist."},e=function(a,b){return"For Chart Selector '"+b+"' : '"+a+"' does not exist. Please insert a valid value for it."},f=function(a,b){return"For Chart Selector '"+b+"' : The value of '"+a+"' is invalid."},g=function(a){return"For Chart Selector '"+a+"' : Invalid data format. Please enter data in one of the following formats : (JSON String, CSV String, CSV file, JSON file, JSON Object)"},h=function(a,b,c){return"For Chart Selector '"+a+"' : The value of '"+b+"' is invalid. Column '"+c+"' doesnot exist in the data"};return{idNotFoundOnDom:a,idAlreadyExistsOnDom:b,idNotFound:c,fieldAlreadyExists:d,fieldNotFound:e,invalidConfig:f,invalidDataFormat:g,invalidColumnName:h}}(),f.dataManipulationFunctions=function(){var a=function(a,b,d,e,f){for(var g=d-b,h=(g>>>1)+1;--h>0;)c(a,h,g,b,e);return a},b=function(a,b,d,e,f){for(var g,h=d-b;--h>0;)g=a[b],a[b]=a[b+h],a[b+h]=g,c(a,1,h,b,e);return a.reverse()},c=function(a,b,c,d,e,f){var g=a[--d+b];"TimeStamp"===f?(a[d+b][e]=new Date(parseInt(g[e])).getTime(),g[e]=new Date(parseInt(g[e])).getTime()):(a[d+b][e]=new Date(g[e]).getTime(),g[e]=new Date(g[e]).getTime()),a[d+b].isRawData=!0,g.isRawData=!0;for(var h,i=g[e];(h=b<<1)<=c&&(c>h&&("TimeStamp"===f?(a[d+h][e]=new Date(parseInt(a[d+h][e])).getTime(),a[d+h+1][e]=new Date(parseInt(a[d+h+1][e])).getTime()):(a[d+h][e]=new Date(a[d+h][e]).getTime(),a[d+h+1][e]=new Date(a[d+h+1][e]).getTime()),a[d+h].isRawData=!0,a[d+h+1].isRawData=!0,a[d+h][e]>a[d+h+1][e]&&h++),!(i<=a[d+h][e]));)a[d+b]=a[d+h],b=h;a[d+b]=g},d=function(c,d,e,f){if(!f.isDataSorted){var g=a(c,0,c.length,d,e);return b(g,0,g.length,d,e)}return c},e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=["January","February","March","April","May","June","July","August","September","October","November","December"],h=function(a,b,c,d,h){var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=a.length,A=[],B=-1,C=[],D=-1,E=[],F=-1,G=[],H=-1,I=[],J=-1,K=[],L=-1,M=[],N=[],O=-1,P=0,Q=f.global_data_sets[h.data].alias,R={},S=[];for(l=0;z>l;l++)if(h.minGranularity||h.maxGranularity||(n=a[l],"TimeStamp"===d||"YYYYMMDD"===d||"YYYYMMDDHH"===d||"YYYYMMDDHHMM"===d||"YYYYMMDDHHMMSS"===d?("YYYYMMDD"===d||"YYYYMMDDHH"===d||"YYYYMMDDHHMM"===d||"YYYYMMDDHHMMSS"===d?(date_temp=n[b],modified_date=[date_temp.slice(0,4),"/",date_temp.slice(4,6),"/",date_temp.slice(6,8)].join(""),"YYYYMMDDHH"===d?modified_time=[date_temp.slice(8,10),"00","00"].join(":"):"YYYYMMDDHHMM"===d?modified_time=[date_temp.slice(8,10),date_temp.slice(10,12),"00"].join(":"):"YYYYMMDDHHMMSS"===d?modified_time=[date_temp.slice(8,10),date_temp.slice(10,12),date_temp.slice(12,14)].join(":"):modified_time="00:00:00",m=new Date([modified_date,modified_time].join(" "))):m=new Date(parseInt(n[b])),a[l][f.global_data_sets[h.data][b]||b]=m.getTime(),a[l].isRawData=!0,A[B]!=m.getFullYear()&&(A.push(m.getFullYear()),B++),C[D]!=m.getMonth()+1&&(C.push(m.getMonth()+1),D++),E[F]!=m.getDate()&&(E.push(m.getDate()),F++),G[H]!=m.getHours()&&(G.push(m.getHours()),H++),I[J]!=m.getMinutes()&&(I.push(m.getMinutes()),J++),K[L]!=m.getSeconds()&&(K.push(m.getSeconds()),L++)):(m=new Date(n[b]),w=n[b].match(c.regex),o=c.mapping[0]+1,p=c.mapping[1]+1,q=c.mapping[2]+1,r=c.mapping[3]+1,s=c.mapping[4]+1,t=c.mapping[5]+1,a[l][f.global_data_sets[h.data][b]||b]=m.getTime(),a[l].isRawData=!0,-1!=o&&A[B]!=w[o]&&void 0!==w[o]&&(A.push(+w[o]),B++),-1!=p&&C[D]!=+w[p]&&void 0!==w[p]&&(x=e.indexOf(w[p]),y=g.indexOf(w[p]),C.push(-1!==x?x+1:-1!==y?y+1:+w[p]),D++),-1!=q&&E[F]!=w[q]&&void 0!==w[q]&&(E.push(+w[q]),F++),-1!=r&&G[H]!=w[r]&&void 0!==w[r]&&(G.push(+w[r]),H++),-1!=s&&I[J]!=w[s]&&void 0!==w[s]&&(I.push(+w[s]),J++),-1!=t&&K[L]!=w[t]&&void 0!==w[t]&&(K.push(+w[t]),L++))),h.processMissingDataPoint&&(S.push(a[l][b]),h.minimumTimeStep?u=JSON.parse(JSON.stringify(a[0])):l>0?(P=a[l][b]-a[l-1][b],O=M.indexOf(P),-1===O?(M.push(P),N.push(1)):N[O]=N[O]+1):u=JSON.parse(JSON.stringify(a[l]))),Q)for(v in Q)a[l][Q[v]]||(a[l][Q[v]]=a[l][v],delete a[l][v]);if(!h.minGranularity&&!h.maxGranularity)if(h.enableLiveData&&f.chart_configs[h.selector].data_processed){var T=f.chart_configs[h.selector].data_processed.min_max_granularity[2];R.min_max_granularity=j(T[0].length>0?T[0].concat(A):A,T[1].length>0?T[1].concat(C):C,T[2].length>0?T[2].concat(E):E,T[3].length>0?T[3].concat(G):G,T[4].length>0?T[4].concat(I):I,T[5].length>0?T[5].concat(K):K)}else R.min_max_granularity=j(A,C,E,G,I,K);return h.processMissingDataPoint&&(M.length>1||h.minimumTimeStep)?(h.minimumTimeStepGranularity=h.minimumTimeStepGranularity?h.minimumTimeStepGranularity:R.min_max_granularity[0],R.data=a.concat(i(a,b,h.minimumTimeStep,h.minimumTimeStepGranularity,S,M,N,u))):R.data=a,h.width&&(R.initial_zoom_level=k(h,R.min_max_granularity[2],a,b)),R},i=function(a,b,c,d,e,f,g,h){var i,j,k,l,m=0,n=0,o=1,p=[],q=0,r=[],s=[];for(j in h)h[j]="NA";if(c)n=c;else{switch(g.areAllValuesSame()?n=Math.min.apply(Math,g):(m=g.indexOf(Math.max.apply(Math,g)),n=f[m]),d){case"second":o=1e3;break;case"minute":o=6e4;break;case"hour":o=36e5;break;case"day":o=864e5;break;case"month":o=2592e6;break;case"second":o=31104e6}n=Math.floor(n/o)}for(k=d3.extent(a,function(a){return a[b]}),l=d3.time[d].rangePlusBinaryForMDP(k[0],k[1],n,e),p=l[0],r=l[1],q=r.length,i=0;q>i;i++)1===r[i]&&(h=JSON.parse(JSON.stringify(h)),h[b]=p[i],h.isRawData=!1,s.push(h));return s},j=function(a,b,c,d,e,f){var g,h,i,j=a.unique(),k=b.unique(),l=c.unique(),m=d.unique(),n=e.unique(),o=f.unique();return j.length>1?h="year":k.length>1?h="month":l.length>1?h="day":m.length>1?h="hour":n.length>1?h="minute":o.length>1&&(h="second"),o.length>1?g="second":n.length>1?g="minute":m.length>1?g="hour":l.length>1?g="day":k.length>1?g="month":j.length>1&&(g="year"),i=[j,k,l,m,n,o],[g,h,i]},k=function(a,b,c,d){var e=a.width*a.dataPointsPerPixel;return Math.round(e)},l=function(a,b){var c=a.length;if(b>=c)return a;b/=2;for(var d,e,f,g=Math.ceil(c/b),h=[],i=0;b>i;i++)if(d=a.splice(0,g),e=d.length,e>2)f=e%2===0?e/2-1:Math.floor(e/2),h.push(d[0],d[f]),0===a.length&&h.push(d.splice(-1)[0]);else{if(d.length<=0)break;h=h.concat(d)}return h},m=function(a,b){var c,d,e,f,g,h,i=[],j=a.columnHeaders,k=j.length,l=a.rows,m=l.length,n=b.split,o=b.substitute,s=b.concat;for(c=0;m>c;c++)for(i[c]={},d=0;k>d;d++){if(i[c][b.alias[j[d].name]]=l[c][d],n&&n.length>0)for(f=n.length,e=0;f>e;e++)n[e].column===b.alias[j[d].name]&&p(i[c],n[e].column,n[e].delimeter,n[e].newColumns);if(o&&o.length>0)for(g=o.length,e=0;g>e;e++)o[e].column===b.alias[j[d].name]&&q(i[c],o[e].column,o[e].match,o[e].replace,o[e].isExact);if(s&&s.length>0)for(h=s.length,e=0;h>e;e++)r(i[c],s[e].columns,s[e].delimeter,s[e].newColumn)}return i},n=function(a,b){for(var c,d,e=[],f=a.feed.entry,g=b.dimensions,h=g.map(function(a){return"gsx$"+a}),i=b.metrics,j=i.map(function(a){return"gsx$"+a}),k=0,l=f.length;l>k;k++){for(e[k]={},c=0,d=g.length;d>c;c++)e[k][b.alias[g[c]]]=f[k][h[c]].$t;for(c=0,d=i.length;d>c;c++)e[k][b.alias[i[c]]]=f[k][j[c]].$t}return e},o=function(a,b,c,d){var e,g,h,i="object"!=typeof b?JSON.parse(b):b,j=i.length,k="";if(c){h="";for(e in i[0])d.indexOf(e)>-1&&(h+=e+",");h=h.slice(0,-1),k+=h+"\r\n"}for(g=0;j>g;g++){h="";for(e in i[g])d.indexOf(e)>-1&&(h+='"'+i[g][e]+'",');h.slice(0,h.length-1),k+=h+"\r\n"}if(""===k)return void alert("Invalid data");var l=f.global_data_sets[a.data].dataName||"MyReport";l=l.replace(/ /g,"_");var m="data:text/csv;charset=utf-8,"+escape(k),n=document.createElement("a");n.href=m,n.style="visibility:hidden",n.download=l+".csv",document.body.appendChild(n),n.click(),document.body.removeChild(n)},p=function(a,b,c,d){var e,f=a[b].split(c),g=d.length;for(e=0;g>e;e++)a[d[e]]=f[e];return delete a[b],a},q=function(a,b,c,d,e){var f,g=c.length;if(e){for(f=0;g>f;f++)c[f]=c[f].toLowerCase();c.indexOf(a[b].toLowerCase())>-1&&(a[b]=d)}else regex=new RegExp("[a-z A-Z0-9\\(\\)\\!\\@\\#\\$\\%\\^\\&\\*\\_\\+\\-\\=\\[\\]\\{\\}\\;\\'\\:\\\"\\\\\\/\\|\\, ]*"+c.join("[a-z A-Z0-9\\(\\)\\!\\@\\#\\$\\%\\^\\&\\*\\_\\+\\-\\=\\[\\]\\{\\}\\;\\'\\:\\\"\\\\\\/\\|\\, ]*|[a-z A-Z0-9\\(\\)\\!\\@\\#\\$\\%\\^\\&\\*\\_\\+\\-\\=\\[\\]\\{\\}\\;\\'\\:\\\"\\\\\\/\\|\\, ]*")+"[a-z A-Z0-9\\(\\)\\!\\@\\#\\$\\%\\^\\&\\*\\_\\+\\-\\=\\[\\]\\{\\}\\;\\'\\:\\\"\\\\\\/\\|\\, ]*","gi"),a[b]=a[b].replace(regex,d);return a},r=function(a,b,c,d){var e,f=b.length;for(a[d]="",e=0;f>e;e++)a[d]+=a[b[e]];return a};return f.mediator.subscribe("dataProcessing",h),f.mediator.subscribe("heapSort",d),f.mediator.subscribe("findMissingDataPoint",i),f.mediator.subscribe("simplifyDataset",l),f.mediator.subscribe("transformGAData",m),f.mediator.subscribe("transformGSXData",n),f.mediator.subscribe("downloadDataURI",o),{dataProcessing:h,sort:d,simplifyDataset:l,findMissingDataPoint:i,mmm_array:e,mmmm_array:g,week_day_array:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}}(),f.getData=function(){var a=function(a,b){var c;return"smartDefault"!==b.dataFormat?c=b.dataFormat:a.constructor==Array?c="json_obj":-1!=a.indexOf("[")&&-1!=a.indexOf("{")?c="json_string":"string"==typeof a&&-1!=a.indexOf(",")?c="csv_string":a.indexOf(".json")>-1?c="json":a.indexOf(".csv")>-1?c="csv":a.indexOf("json")>-1?c="json":a.indexOf("csv")>-1&&(c="csv"),c},b=function(b,c,d,e,g){var h,i=d.options.selector,j=a(b,d.options);switch(f.chart_status[i].status===!1&&(f.chart_status[i].status="inprogress"),d.options.dataSource){case"google-analytics":var k,l;h=new XMLHttpRequest,k=f.mediator.publish("createGAQuery",d.options),h.onreadystatechange=function(){4==h.readyState&&200==h.status&&(console.log(JSON.parse(h.responseText)),l=f.mediator.publish("transformGAData",JSON.parse(h.responseText),d.options),f.mediator.publish(c,d,l,e,g))},k=k[k.name],h.open("GET",k.query,!0),h.send();break;case"google-sheets":var m,n=f.mediator.publish("createGSXQuery",d.options);h=new XMLHttpRequest,h.onreadystatechange=function(){4==h.readyState&&200==h.status&&(console.log(JSON.parse(h.responseText)),m=f.mediator.publish("transformGSXData",JSON.parse(h.responseText),d.options),console.log("gsx_data",m),f.mediator.publish(c,d,m,e,g))},h.open("GET",n,!0),h.setRequestHeader("Authorization","Bearer "+d.options.accessToken),h.send();break;case"":switch(j){case"json_obj":f.mediator.publish(c,d,b,e,g);break;case"json_string":b=JSON.parse(b),f.mediator.publish(c,d,b,e,g);break;case"csv_string":b=Papa.parse(b),f.mediator.publish(c,d,b.data,e,g);break;case"json":d3.json(b,function(a){f.mediator.publish(c,d,a,e,g)});break;case"csv":Papa.parse(b,{download:!0,header:!0,complete:function(a){f.mediator.publish(c,d,a.data,e,g)}})}}},c=function(b,c,d){var e=f.global_data_sets[d];switch(format=a(b,e),f.data_load_status[d].status===!1&&(f.data_load_status[d].status="inprogress"),e.dataSource){case"google-analytics":var g,h,i=new XMLHttpRequest;g=f.mediator.publish("createGAQuery",e),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&(h=f.mediator.publish("transformGAData",JSON.parse(i.responseText),e),f.data_load_status[d].status="complete",f.global_data_sets[d].raw_data=h,console.time("dataSource"),f.mediator.publish(c,d,"data",h),console.timeEnd("dataSource"))},g=g[g.name],i.open("GET",g.query,!0),i.send();break;case"google-sheets":var j,k=f.mediator.publish("createGSXQuery",e);i=new XMLHttpRequest,i.onreadystatechange=function(){4==i.readyState&&200==i.status&&(j=f.mediator.publish("transformGSXData",JSON.parse(i.responseText),e),f.data_load_status[d].status="complete",f.global_data_sets[d].raw_data=j,f.mediator.publish(c,d,"data",j))},i.open("GET",k,!0),i.setRequestHeader("Authorization","Bearer "+e.accessToken),i.send();break;case"":switch(f.data_load_status[d].status="complete",format){case"json_obj":f.mediator.publish(c,d,"data",b);break;case"json_string":b=JSON.parse(b),f.mediator.publish(c,d,"data",b);break;case"csv_string":b=Papa.parse(b),f.mediator.publish(c,d,"data",b);break;case"json":d3.json(b,function(a){f.mediator.publish(c,d,"data",a)});break;case"csv":Papa.parse(b,{download:!0,header:!0,complete:function(a){f.mediator.publish(c,d,"data",a.data)}})}}};return f.mediator.subscribe("parseData",b),f.mediator.subscribe("parseGlobalData",c),f.mediator.subscribe("getDataFormat",a),{parseData:b,getDataFormat:a}}(),f.numberFormatFunctions=function(){var a=function(a,b){return d3.format(a)(b)};return f.mediator.subscribe("numberFormatter",a),{numberFormatter:a}}(),f.dateFormatFunctions=function(){var a=function(){var a=[{format:["YYYY MM DD","YYYY M D","YYYY MMM DD","YYYY MMMM DD"],regex:/^(\d{4})[,|.|\-| |\/](\d{1,2}|\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{1,2})$/i,mapping:[0,1,2,-2,-2,-2]},{format:["YYYY MM DD hh:mm:ss","YYYY M D hh:mm:ss","YYYY MMM DD hh:mm:ss","YYYY MMMM DD hh:mm:ss"],regex:/^(\d{4})[,|.|\-| |\/](\d{1,2}|\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/i,mapping:[0,1,2,3,4,5]},{format:["YYYY MM DD hh:mm","YYYY M D hh:mm","YYYY MMM DD hh:mm","YYYY MMMM DD hh:mm"],regex:/^(\d{4})[,|.|\-| |\/](\d{1,2}|\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{1,2}) (\d{1,2}):(\d{1,2})$/i,mapping:[0,1,2,3,4,-2]},{format:["YYYY MM DD hh","YYYY M D hh","YYYY MMM DD hh","YYYY MMMM DD hh"],regex:/^(\d{4})[,|.|\-| |\/](\d{1,2}|\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{1,2}) (\d{1,2})$/i,mapping:[0,1,2,3,-2,-2]},{format:["MM DD YYYY","M D YYYY"],regex:/^(\d{1,2})[,|.|\-| |\/](\d{1,2})[,|.|\-| |\/](\d{4})$/i,mapping:[2,0,1,-2,-2,-2],test:["DD MM YYYY","D M YYYY"],replaceRegex:"$2/$1/$3"},{format:["MM DD YYYY hh:mm:ss","M D YYYY hh:mm:ss"],regex:/^(\d{1,2})[,|.|\-| |\/](\d{1,2})[,|.|\-| |\/](\d{4}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/i,mapping:[2,0,1,3,4,5],test:["DD MM YYYY hh:mm:ss","D M YYYY hh:mm:ss"],replaceRegex:"$2/$1/$3"},{format:["MM DD YYYY hh:mm","M D YYYY hh:mm"],regex:/^(\d{1,2})[,|.|\-| |\/](\d{1,2})[,|.|\-| |\/](\d{4}) (\d{1,2}):(\d{1,2})$/i,mapping:[2,0,1,3,4,-2],test:["DD MM YYYY hh:mm","D M YYYY hh:mm"],replaceRegex:"$2/$1/$3"},{format:["MM DD YYYY hh","M D YYYY hh"],regex:/^(\d{1,2})[,|.|\-| |\/](\d{1,2})[,|.|\-| |\/](\d{4}) (\d{1,2})$/i,mapping:[2,0,1,3,-2,-2],test:["DD MM YYYY hh","D M YYYY hh"],replaceRegex:"$2/$1/$3"},{format:["MMM DD YYYY","MMMM DD YYYY"],regex:/^(\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{1,2})[,|.|\-| |\/](\d{4})$/i,mapping:[2,0,1,-2,-2,-2]},{format:["MMM DD YYYY hh:mm:ss","MMMM DD YYYY hh:mm:ss"],regex:/^(\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{1,2})[,|.|\-| |\/](\d{4}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/i,mapping:[2,0,1,3,4,5]},{format:["MMM DD YYYY hh:mm","MMMM DD YYYY hh:mm"],regex:/^(\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{1,2})[,|.|\-| |\/](\d{4}) (\d{1,2}):(\d{1,2})$/i,
mapping:[2,0,1,3,4,-2]},{format:["MMM DD YYYY hh","MMMM DD YYYY hh"],regex:/^(\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{1,2})[,|.|\-| |\/](\d{4}) (\d{1,2})$/i,mapping:[2,0,1,3,-2,-2]},{format:["DD MMM YYYY","DD MMMM YYYY"],regex:/^(\d{1,2})[,|.|\-| |\/](\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{4})$/i,mapping:[2,1,0,-2,-2,-2]},{format:["DD MMM YYYY hh:mm:ss","DD MMMM YYYY hh:mm:ss"],regex:/^(\d{1,2})[,|.|\-| |\/](\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{4}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/i,mapping:[2,1,0,3,4,5]},{format:["DD MMM YYYY hh:mm","DD MMMM YYYY hh:mm"],regex:/^(\d{1,2})[,|.|\-| |\/](\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{4}) (\d{1,2}):(\d{1,2})$/i,mapping:[2,1,0,3,4,-2]},{format:["DD MMM YYYY hh","DD MMMM YYYY hh"],regex:/^(\d{1,2})[,|.|\-| |\/](\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))[,|.|\-| |\/](\d{4}) (\d{1,2})$/i,mapping:[2,1,0,3,-2,-2]},{format:["YYYY MM"],regex:/^(\d{4})[,|.|\-| |\/](\d{1,2}|\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?))$/i,mapping:[0,1,-2,-2,-2,-2]},{format:["YYYY"],regex:/^(\d{4})$/,mapping:[0,-2,-2,-2,-2,-2]},{format:["hh:mm:ss"],regex:/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,mapping:[-2,-2,-2,0,1,2]},{format:["hh:mm"],regex:/^(\d{1,2}):(\d{1,2})$/,mapping:[-2,-2,-2,0,1,-2]},{format:["hh"],regex:/^(\d{1,2})$/,mapping:[-2,-2,-2,0,-2,-2]},{format:["YYYY-MM-DDThh:mm:ss"],regex:/^(\d{4})-(\d{2})-(\d{2})T(\d{1,2}):(\d{1,2}):(\d{1,2})$/,mapping:[0,1,2,3,4,5]},{format:["YYYY-MM-DDThh:mm"],regex:/^(\d{4})-(\d{2})-(\d{2})T(\d{1,2}):(\d{1,2})$/,mapping:[0,1,2,3,4,-2]},{format:["YYYY-MM-DDThh:mm:ss"],regex:/^(\d{4})-(\d{2})-(\d{2})T(\d{1,2})$/,mapping:[0,1,2,3,-2,-2]},{format:["DAY, DD MMM YYYY","DAY, DD MMMM YYYY"],regex:/^(\b(?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?))[,] (\d{1,2}) (\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)) (\d{4})$/i,mapping:[3,2,1,-2,-2,-2]},{format:["DAY, DD MMM YYYY hh:mm:ss","DAY, DD MMMM YYYY hh:mm:ss"],regex:/^(\b(?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?))[,] (\d{1,2}) (\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)) (\d{4})[ |,](\d{1,2}):(\d{1,2}):(\d{1,2})$/i,mapping:[3,2,1,4,5,6]},{format:["DAY, DD MMM YYYY hh:mm","DAY, DD MMMM YYYY hh:mm"],regex:/^(\b(?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?))[,] (\d{1,2}) (\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)) (\d{4})[ |,](\d{1,2}):(\d{1,2})$/i,mapping:[3,2,1,4,5,-2]},{format:["DAY, DD MMM YYYY hh","DAY, DD MMMM YYYY hh"],regex:/^(\b(?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?))[,] (\d{1,2}) (\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)) (\d{4})[ |,](\d{1,2})$/i,mapping:[3,2,1,4,-2,-2]},{format:["DAY, MMM DD YYYY","DAY, MMMM DD YYYY"],regex:/^(\b(?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?))[,] (\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)) (\d{1,2}) (\d{4})$/i,mapping:[3,1,2,-2,-2,-2]},{format:["DAY, MMM DD YYYY hh:mm:ss","DAY, MMMM DD YYYY hh:mm:ss"],regex:/^(\b(?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?))[,] (\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)) (\d{1,2}) (\d{4})[ |,](\d{1,2}):(\d{1,2}):(\d{1,2})$/i,mapping:[3,1,2,4,5,6]},{format:["DAY, MMM DD YYYY hh:mm","DAY, MMMM DD YYYY hh:mm"],regex:/^(\b(?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?))[,] (\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)) (\d{1,2}) (\d{4})[ |,](\d{1,2}):(\d{1,2})$/i,mapping:[3,1,2,4,5,-2]},{format:["DAY, MMM DD YYYY hh","DAY, MMMM DD YYYY hh"],regex:/^(\b(?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?))[,] (\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sept?|September|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)) (\d{1,2}) (\d{4})[ |,](\d{1,2})$/i,mapping:[3,1,2,4,-2,-2]},{format:["YYYYMMDD"],regex:/^(\d{8})$/,mapping:[0,1,2,-2,-2,-2]},{format:["YYYYMMDDHH"],regex:/^(\d{10})$/,mapping:[0,1,2,3,-2,-2]},{format:["YYYYMMDDHHMM"],regex:/^(\d{12})$/,mapping:[0,1,2,3,4,-2]},{format:["YYYYMMDDHHMMSS"],regex:/^(\d{14})$/,mapping:[0,1,2,3,4,5]}];return a},c=function(c,d,e){var f,g,h,i,j=a(),k=(d.length,j.length),l=d[0][e];if(!l)return b("For Chart Selector '"+c+"' : Invalid date format (non string). Please enter data with valid date format."),{format:"Invalid format"};if("number"==typeof l)f={format:"TimeStamp"},g="TimeStamp";else if(l.match(j[17].regex))f=j[17],g=f.format[0];else if(l.match(j[32].regex))f={format:"YYYYMMDD"},g="YYYYMMDD";else if(l.match(j[33].regex))f={format:"YYYYMMDDHH"},g="YYYYMMDDHH";else if(l.match(j[34].regex))f={format:"YYYYMMDDHHMM"},g="YYYYMMDDHHMM";else if(l.match(j[35].regex))f={format:"YYYYMMDDHHMMSS"},g="YYYYMMDDHHMMSS";else for(var m=0;k>m;m++){if(l.match(j[m].regex)){f=j[m],g=f.format[0];break}if(!isNaN(l)){f={format:"TimeStamp"},g="TimeStamp";break}}return f&&"YYYY MM"===f.format[0]?(b("For Chart Selector '"+c+"' : Invalid date format (YYYY MM). Please enter data with valid date format."),{format:"Invalid format"}):f&&"TimeStamp"!==f.format&&"YYYYMMDD"!==f.format&&"YYYYMMDDHH"!==f.format&&"YYYYMMDDHHMM"!==f.format&&"YYYYMMDDHHMMSS"!==f.format&&(h=new Date(l).getFullYear(),i=l.match(f.regex)[f.mapping[0]+1],h.toString()!==i)?(b("For Chart Selector '"+c+"' : Invalid date format.Please enter data with valid date format."),{format:"Invalid format"}):f?{format_data:f,format:g}:(b("For Chart Selector '"+c+"' : Invalid date format.Please enter data with valid date format."),{format:"Invalid format"})},d=function(a,b){return"multi"===a&&b?d3.time.format.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%b",function(a){return a.getMonth()}],["%Y",function(){return!0}]])(b):"multi"===a?d3.time.format.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",function(){return!0}]]):b?d3.time.format(a)(b):d3.time.format(a)};return f.mediator.subscribe("detectDateFormat",c),f.mediator.subscribe("dateFormatter",d),{detectDateFormat:c,dateFormatter:d,dateFormatRegex:a}}(),f["default"].mandatory_configs={selector:{validate_for:"existsOnDOM",mandatory:!0,validateIf:!0},dateColumnName:{validate_for:"string",mandatory:!0,validateIf:!0},metricsColumnName:{validate_for:"array",mandatory:!0,validateIf:!0}},f["default"].chart_options={width:{value:100,validate_for:"number",validateIf:!0},height:{value:100,validate_for:"number",validateIf:!0},decimal_precision:{value:0,validate_for:"number",validateIf:!0},chartColor:{value:["red","green","blue","orange","yellow","purple","pink","black","grey"],validateIf:!0,validate_for:"array"},marginLeft:{value:20,validateIf:!0,validate_for:"number"},marginTop:{value:20,validateIf:!0,validate_for:"number"},marginBottom:{value:20,validateIf:!0,validate_for:"number"},marginRight:{value:20,validateIf:!0,validate_for:"number"},bgColor:{value:"#f6f6f6",validateIf:!0,validate_for:"string"},chartTransitionSpeed:{value:0,validateIf:!0,validate_for:"number"},chartBorderWidth:{value:1,validateIf:["showChartBorder",!0],validate_for:"number"},chartBorderRadius:{value:3,validateIf:["showChartBorder",!0],validate_for:"number"},chartBorderStyle:{value:"solid",validateIf:["showChartBorder",!0],validate_for:"string"},chartBorderColor:{value:"lightgray",validateIf:["showChartBorder",!0],validate_for:"string"},caption:{value:"",validateIf:["showCaption",!0],validate_for:"string"},captionFontSize:{value:14,validateIf:["showCaption",!0],validate_for:"number"},captionFontColor:{value:"#333",validateIf:["showCaption",!0],validate_for:"string"},captionFontWeight:{value:"600",validateIf:["showCaption",!0],validate_for:"specificValues",specific_values:["normal","bold"]},captionFontFamily:{value:"'Roboto', sans-serif",validateIf:["showCaption",!0],validate_for:"string"},captionFontStyle:{value:"normal",validateIf:["showCaption",!0],validate_for:"specificValues",specific_values:["italic","oblique","normal","initial","inherit"]},captionAlign:{value:"left",validateIf:["showCaption",!0],validate_for:"specificValues",specific_values:["left","oblique"]},captionMargin:{value:-45,validateIf:["showCaption",!0],validate_for:"number"},subCaption:{value:"",validateIf:["showSubCaption",!0],validate_for:"string"},subCaptionFontSize:{value:11,validateIf:["showSubCaption",!0],validate_for:"number"},subCaptionFontColor:{value:"#777",validateIf:["showSubCaption",!0],validate_for:"string"},subCaptionFontWeight:{value:"400",validateIf:["showSubCaption",!0],validate_for:"specificValues",specific_values:["normal","bold"]},subCaptionFontFamily:{value:"'Roboto', sans-serif",validateIf:["showSubCaption",!0],validate_for:"string"},subCaptionFontStyle:{value:"normal",validateIf:["showCaption",!0],validate_for:"specificValues",specific_values:["italic","oblique","normal","initial","inherit"]},gridColor:{value:"#e7e7e7",validateIf:!0,validate_for:"string"},gridOpacity:{value:100,validateIf:!0,validate_for:"number"},tooltipBorderBodyWidth:{value:1,validateIf:["showTooltip",!0],validate_for:"number"},tooltipBorderBodyRadius:{value:3,validateIf:["showTooltip",!0],validate_for:"number"},tooltipBorderBodyStyle:{value:"solid",validateIf:["showTooltip",!0],validate_for:"string"},tooltipBorderBodyColor:{value:"#CCCCCC",validateIf:["showTooltip",!0],validate_for:"string"},tooltipBgBodyColor:{value:"white",validateIf:["showTooltip",!0],validate_for:"string"},tooltipBgBodyOpacity:{value:95,validateIf:["showTooltip",!0],validate_for:"number"},tooltipBodyFontSize:{value:12,validateIf:["showTooltip",!0],validate_for:"number"},tooltipBodyFontFamily:{value:"'roboto', sans-serif",validateIf:["showTooltip",!0],validate_for:"string"},tooltipBodyFontWeight:{value:"normal",validateIf:["showTooltip",!0],validate_for:"specificValues",specific_values:["normal","bold"]},tooltipBodyFontColor:{value:"#4F4F4F",validateIf:["showTooltip",!0],validate_for:"string"},tooltipBorderFooterWidth:{value:0,validateIf:["showTooltip",!0],validate_for:"number"},tooltipBorderFooterRadius:{value:3,validateIf:["showTooltip",!0],validate_for:"number"},tooltipBorderFooterStyle:{value:"solid",validateIf:["showTooltip",!0],validate_for:"string"},tooltipBorderFooterColor:{value:"#CBCBCB",validateIf:["showTooltip",!0],validate_for:"string"},tooltipBgFooterColor:{value:"white",validateIf:["showTooltip",!0],validate_for:"string"},tooltipBgFooterOpacity:{value:95,validateIf:["showTooltip",!0],validate_for:"number"},tooltipFooterFontSize:{value:8,validateIf:["showTooltip",!0],validate_for:"number"},tooltipFooterFontFamily:{value:"Helvetica Neue,Helvetica,Arial,sans-serif",validateIf:["showTooltip",!0],validate_for:"string"},tooltipFooterFontWeight:{value:"normal",validateIf:["showTooltip",!0],validate_for:"specificValues",specific_values:["normal","bold"]},tooltipFooterFontColor:{value:"#1D1D1D",validateIf:["showTooltip",!0],validate_for:"string"},xAxisPosition:{value:"bottom",validateIf:["showXAxis",!0],validate_for:"specificValues",specific_values:["top","bottom"]},xAxisLineColor:{value:"#e7e7e7",validateIf:["showXAxis",!0],validate_for:"string"},xAxisLineThickness:{value:1,validateIf:["showXAxis",!0],validate_for:"number"},xAxisGranularity:{value:"none",validateIf:["showXAxis",!0],validate_for:"string"},xAxisTimeChangeInParentGranularity:{value:!1,validateIf:["showXAxis",!0],validate_for:"boolean"},xAxisLineOpacity:{value:1,validateIf:["showXAxis",!0],validate_for:"number"},showXAxisRange:{value:!1,validateIf:!0,validate_for:"boolean"},xAxisRangeFontSize:{value:11,validateIf:["showXAxisRange",!0],validate_for:"number"},xAxisRangeFontFamily:{value:"'roboto', sans-serif",validateIf:["showXAxisRange",!0],validate_for:"string"},xAxisRangeFontColor:{value:"#1D1D1D",validateIf:["showXAxisRange",!0],validate_for:"string"},xAxisRangeFontWeight:{value:"normal",validateIf:["showXAxisRange",!0],validate_for:"specificValues",specific_values:["bold","normal"]},xAxisRangeOpacity:{value:70,validateIf:["showXAxisRange",!0],validate_for:"number"},xAxisTitle:{value:"",validateIf:["showXAxis",!0],validate_for:"string"},xAxisTitleFontFamily:{value:"'roboto', sans-serif",validateIf:["showXAxis",!0],validate_for:"string"},xAxisTitleFontSize:{value:12,validateIf:["showXAxis",!0],validate_for:"number"},xAxisTitleFontColor:{value:"#777",validateIf:["showXAxis",!0],validate_for:"string"},xAxisTitleFontWeight:{value:"600",validateIf:["showXAxis",!0],validate_for:"specificValues",specific_values:["bold","normal"]},xAxisTitleOpacity:{value:100,validateIf:["showXAxis",!0],validate_for:"number"},xAxisTitlePosition:{value:"center",validateIf:["showXAxis",!0],validate_for:"specificValues",specific_values:["left","right","center"]},xAxisTickSize:{value:0,validateIf:["showXAxis",!0],validate_for:"number"},xAxisOuterTickSize:{value:0,validateIf:["showXAxis",!0],validate_for:"number"},xAxisTickColor:{value:"#e7e7e7",validateIf:["showXAxis",!0],validate_for:"string"},xAxisTickPosition:{value:"bottom",validateIf:["showXAxis",!0],validate_for:"specificValues",specific_values:["top","bottom"]},xAxisTickInterval:{value:0,validateIf:["showXAxis",!0],validate_for:"number"},xAxisTickIntervalGranularity:{value:"smartDefault",validateIf:["showXAxis",!0],validate_for:"specificValues",specific_values:["second","minute","hour","day","month","year"]},xAxisTickPadding:{value:6,validateIf:["showXAxis",!0],validate_for:"number"},xAxisTickMargin:{value:[0,0],validateIf:["showXAxis",!0],validate_for:"array"},xAxisTicksOverlapHandlingMethod:{value:"none",validateIf:["showXAxis",!0],validate_for:"specificValues",specific_values:["wrapping","slicing","abbreviated","none"]},xAxisTicksPrefix:{value:"",validateIf:["showXAxis",!0],validate_for:"string"},xAxisTicksSuffix:{value:"",validateIf:["showXAxis",!0],validate_for:"string"},xAxisTickOpacity:{value:1,validateIf:["showXAxis",!0],validate_for:"number"},xAxisTickThickness:{value:1,validateIf:["showXAxis",!0],validate_for:"number"},xAxisNoOfTicks:{value:5,validateIf:["showXAxis",!0],validate_for:"number"},xAxisTickValues:{value:"smartDefault",validateIf:["showXAxis",!0],validate_for:"array"},xAxisTickValueFontFamily:{value:"'roboto', sans-serif",validateIf:["showXAxis",!0],validate_for:"string"},xAxisTickValueSize:{value:9,validateIf:["showXAxis",!0],validate_for:"number"},xAxisTickValueColor:{value:"#777",validateIf:["showXAxis",!0],validate_for:"string"},xAxisTickValueWeight:{value:"400",validateIf:["showXAxis",!0],validate_for:"specificValues",specific_values:["bold","normal"]},xAxisTickValuesFormat:{value:"multi",validateIf:["showXAxis",!0],validate_for:["string","function"]},yAxisPosition:{value:"left",validateIf:["showYAxis",!0],validate_for:"specificValues",specific_values:["left","right"]},yAxisColor:{value:"#e7e7e7",validateIf:["showYAxis",!0],validate_for:"string"},yAxisThickness:{value:0,validateIf:["showYAxis",!0],validate_for:"number"},yAxisLineOpacity:{value:0,validateIf:["showYAxis",!0],validate_for:"number"},yAxisTitle:{value:"",validateIf:["showYAxis",!0],validate_for:"string"},yAxisTitleFontFamily:{value:"'roboto', sans-serif",validateIf:["showYAxis",!0],validate_for:"string"},yAxisTitleFontSize:{value:12,validateIf:["showYAxis",!0],validate_for:"number"},yAxisTitleFontColor:{value:"#777",validateIf:["showYAxis",!0],validate_for:"string"},yAxisTitleFontWeight:{value:"300",validateIf:["showYAxis",!0],validate_for:"specificValues",specific_values:["bold","number"]},yAxisTitlePosition:{value:"center",validateIf:["showYAxis",!0],validate_for:"specificValues",specific_values:["center","top","bottom"]},yAxisTitleOpacity:{value:100,validateIf:["showYAxis",!0],validate_for:"number"},yAxisTickSize:{value:0,validateIf:["showYAxis",!0],validate_for:"number"},yAxisOuterTickSize:{value:0,validateIf:["showYAxis",!0],validate_for:"number"},yAxisTickColor:{value:"#e7e7e7",validateIf:["showYAxis",!0],validate_for:"string"},yAxisTickPosition:{value:"left",validateIf:["showYAxis",!0],validate_for:"specificValues",specific_values:["right","left"]},yAxisTickInterval:{value:0,validateIf:["showYAxis",!0],validate_for:"number"},yAxisTickPadding:{value:6,validateIf:["showYAxis",!0],validate_for:"number"},yAxisTickMargin:{value:[0,0],validateIf:["showYAxis",!0],validate_for:"array"},yAxisTicksPrefix:{value:"",validateIf:["showYAxis",!0],validate_for:"string"},yAxisTicksSuffix:{value:"",validateIf:["showYAxis",!0],validate_for:"string"},yAxisTickOpacity:{value:1,validateIf:["showYAxis",!0],validate_for:"number"},yAxisTickThickness:{value:1,validateIf:["showYAxis",!0],validate_for:"number"},yAxisNoOfTicks:{value:5,validateIf:["showYAxis",!0],validate_for:"number"},yAxisTickValues:{value:"smartDefault",validateIf:["showYAxis",!0],validate_for:"array"},yAxisTickFormat:{value:"smartDefault",validateIf:["showYAxis",!0],validate_for:["string","function"]},yAxisTickValueFontFamily:{value:"'roboto', sans-serif",validateIf:["showYAxis",!0],validate_for:"string"},yAxisTickValueSize:{value:9,validateIf:["showYAxis",!0],validate_for:"number"},yAxisTickValueColor:{value:"#777",validateIf:["showYAxis",!0],validate_for:"string"},yAxisTickValueWeight:{value:"400",validateIf:["showYAxis",!0],validate_for:"specificValues",specific_values:["bold","normal"]},processMissingDataPoint:{value:!0,validateIf:!0,validate_for:"boolean"},minimumTimeStep:{value:1,validateIf:!0,validate_for:"number"},minimumTimeStepGranularity:{value:"day",validateIf:!0,validate_for:"specificValues",specific_values:["year, month, day, hour, minute, second"]},processingMethod:{value:{disable:"all"},validateIf:!0,validate_for:"specificValues",specific_values:["disable","enable","hide"]},isDataSorted:{value:!0,validateIf:!0,validate_for:"boolean"},dataFormat:{value:"smartDefault",validateIf:!0,validate_for:"specificValues",specific_values:["json","csv"]},dataSource:{value:"",validateIf:!0,validate_for:"string"},gaId:{value:"",validateIf:["dataSource",!0],validate_for:"string"},startDate:{value:"",validateIf:["dataSource",!0],validate_for:"string"},endDate:{value:"",validateIf:["dataSource",!0],validate_for:"string"},accessToken:{value:"",validateIf:["dataSource",!0],validate_for:"string"},numberprefix:{value:"",validateIf:!0,validate_for:"string"},numbersuffix:{value:"",validateIf:!0,validate_for:"string"},simplifyDataset:{value:!0,validate_for:"boolean",validateIf:!0},dataPointsPerPixel:{value:.1,validateIf:!0,validate_for:"number"},outputDateFormat:{value:"%a %b %e %Y",validateIf:!0,validate_for:"string"},outputNumberFormat:{value:".2f",validateIf:!0,validate_for:"string"},dimensionalAnalysisHighlightColor:{value:"orange",validateIf:["enableDimensionalAnalysis",!0],validate_for:"string"},borderThickness:{value:1,validateIf:["chartType","column"],validate_for:"number"},bordercolor:{value:"white",validateIf:["chartType","column"],validate_for:"string"}},f["default"].chart_features={showCaption:{value:!1,validateIf:!0,validate_for:"boolean"},showSubCaption:{value:!1,validateIf:!0,validate_for:"boolean"},showXAxis:{value:!0,validateIf:!0,validate_for:"boolean"},showYAxis:{value:!0,validateIf:!0,validate_for:"boolean"},showXAxisGrid:{value:!1,validateIf:!0,validate_for:"boolean"},showYAxisGrid:{value:!1,validateIf:!0,validate_for:"boolean"},showTooltip:{value:!0,validateIf:!0,validate_for:"boolean"},showCrosshair:{value:!0,validateIf:!0,validate_for:"boolean"},showChartBorder:{value:!0,validateIf:!0,validate_for:"boolean"},enableDimensionalAnalysis:{value:!0,validateIf:!0,validate_for:"boolean"}},f["default"].mandatory_filter_configs={selector:{validate_for:"existsOnDOM",mandatory:!0,validateIf:!0}},f["default"].filter_configs={},f.chartConfigValidation=function(){function e(a,b,c,e){switch(a){case"number":return f.validation.dataTypes(c[b],"number");case"string":return f.validation.dataTypes(c[b],"string");case"boolean":return f.validation.dataTypes(c[b],"boolean");case"array":return f.validation.dataTypes(c[b],"array");case"specificValues":return f.validation.specificValues(c[b],e[b].specific_values);case"betweenValues":return f.validation.betweenValues(c[b],e[b].between_values);case"function":return f.validation.dataTypes(c[b],"function");case"existsOnDOM":return g(c[b]);case"validateArrayOfColor":return d(c[b])}}function h(a,b){var c;switch(a){case"number":return c;case"string":return c;case"boolean":return c;case"array":return c;case"specificValues":return c+=" It should be one of the following values ["+b.specific_values.toString()+"]";case"betweenValues":return c+=" It should be between the following values ["+b.between_values.between.toString()+"] and upto "+b.between_values.decimalPlaces.toString()+"decimal values";case"function":return c;case"existsOnDOM":return c+=" Please enter a valid chart selector"}}var i=function(d,g){var i,j,k,l,m,n="",o=!1;for(j in g)if(m=g[j].validateIf,n="",m===!0||c(d,m[0],m[1]))if(void 0!==d[j]){if(i=g[j].validate_for,k=i.length,i.constructor!==Array)l=e(i,j,d,g);else for(var p=0;k>p&&(l=e(i[p],j,d,g),p>0&&(n+=" OR "),n+=h(i,g[j]),!l);p++);l||(n=f.errors.invalidConfig(j,d.selector)+" "+n,g[j].mandatory?(o=!0,a(n)):(d[j]=g[j].value,b(n)))}else g[j].mandatory?(d=!1,n="Please specify '"+j+"' of the chart in the configuration parameters",a(n)):void 0!==g[j].value&&(d[j]=g[j].value);return o?!1:d};return f.mediator.subscribe("validate",i),{validate:i}}(),f.captionSubCaption=function(){var a=function(a,b){if(a.showCaption&&a.caption.length>0){var c,d,e=f.chart_configs[a.selector],g=e.previousGroupsHeight+a.captionFontSize+4,h={"font-size":a.captionFontSize,"font-family":a.captionFontFamily,"font-weight":a.captionFontWeight,fill:a.captionFontColor,"font-style":a.captionFontStyle};"center"===a.captionAlign?(c=a.width/2,h["text-anchor"]="middle"):"left"===a.captionAlign&&(c=a.marginLeft+a.captionMargin),d=f.mediator.publish("createGroup",a,b,c,g,a.selector+"_svg_caption_group"),d.append("text").attr(h).text(null).append("tspan").text(a.caption),e.previousGroupsHeight+=document.getElementById(a.selector+"_svg_caption_group").getBoundingClientRect().height+4}else a.showCaption=!1},b=function(a,b){if(a.showSubCaption&&a.subCaption.length>0){var c,d,e=f.chart_configs[a.selector],g=e.previousGroupsHeight+a.subCaptionFontSize+1,h={"font-size":a.subCaptionFontSize,fill:a.subCaptionFontColor,"font-family":a.subCaptionFontFamily,"font-weight":a.subCaptionFontWeight,"font-style":a.subCaptionFontStyle};"center"===a.captionAlign?(c=a.width/2,h["text-anchor"]="middle"):"left"===a.captionAlign&&(c=a.marginLeft+a.captionMargin),d=f.mediator.publish("createGroup",a,b,c,g,a.selector+"_svg_sub_caption_group"),5*a.subCaption.length<a.width-160?d.append("text").attr(h).text(null).append("tspan").text(a.subCaption):(d.append("text").attr(h).text(null).append("tspan").text(a.subCaption.slice(0,(a.width-160)/6)+"..."),b.append("svg:image").attr({x:a.width-190,y:g-a.subCaptionFontSize+3,width:10,height:10,"xlink:href":"../../src/img/info.png",id:a.selector+"_sub_caption_info"}).style({cursor:"pointer"}).on("mouseover",function(b){var c=d3.event.pageX-100,d=d3.event.pageY+10,e="<div style='font-size:11px;'>"+a.subCaption+"</div>";f.mediator.publish("renderTooltipContent",a.selector+"_tooltip",e),d3.select("#"+a.selector+"_tooltip").style({top:d+"px",left:c+"px",width:"200px"}),d3.select("#"+a.selector+"_tooltip").style("display","block")}).on("mouseout",function(b){d3.select("#"+a.selector+"_tooltip").style("display","none")})),e.previousGroupsHeight+=document.getElementById(a.selector+"_svg_sub_caption_group").getBoundingClientRect().height+6}else a.showSubCaption=!1},c=function(a,b){var c=f.chart_options[a],d=f.chart_configs[a],e=d.svg;f.mediator.publish("createGroup",c,e,0,0,a+"_marker"),c.captionFontSize,document.createElement("img"),document.getElementById(a)},d=function(a,b){var c,d,e,g=f.chart_options[a],h=f.chart_configs[a];if(c=d3.select("#"+g.selector+"_svg_group"),d=document.querySelector("#"+g.selector+"_svg_group #xaxis").getBoundingClientRect().height,e=f.mediator.publish("createGroup",g,c,h.width/2,h.height+d+g.xAxisTitleFontSize,"xaxis_title_range"),g.showXAxisRange){var i=f.mediator.publish("createGroup",g,e,0,0,"xaxis_range"),j=f.dateFormatFunctions.dateFormatter;i.append("text").attr({fill:g.xAxisRangeFontColor,"font-family":g.xAxisRangeFontFamily,"font-weight":g.xAxisRangeFontWeight,"fill-opacity":g.xAxisRangeOpacity/100,align:"center","text-anchor":"middle"}).style({"font-size":g.xAxisRangeFontSize}).text(j(g.outputDateFormat,new Date(b[0]))+"  -  "+j(g.outputDateFormat,new Date(b[1])))}if(g.showXAxis&&g.xAxisTitle){var k=document.querySelector("#"+g.selector+"_svg_group #xaxis_title_range"),l=k?k.getBoundingClientRect().height+5:0,m=f.mediator.publish("createGroup",g,e,0,l,"xaxis_title");m.append("text").attr({fill:g.xAxisTitleFontColor,"font-family":g.xAxisTitleFontFamily,"font-weight":g.xAxisTitleFontWeight,"fill-opacity":g.xAxisTitleOpacity/100,align:"center","text-anchor":"middle"}).style({"font-size":g.xAxisTitleFontSize}).text(g.xAxisTitle)}},e=function(a,b){if(a.showXAxisRange){var c=d3.select("#"+a.selector+"_svg_group #xaxis_range text"),d=f.dateFormatFunctions.dateFormatter;c.text(d(a.outputDateFormat,new Date(b[0]))+"  -  "+d(a.outputDateFormat,new Date(b[1])))}},g=function(a){var b=f.chart_options[a];f.chart_configs[a];if(b.showYAxis&&b.yAxisTitle&&!document.querySelector("#"+b.selector+"_svg_group #yaxis_title")){var c=d3.select("#"+b.selector+"_svg_group"),d=document.querySelector("#"+b.selector+"_svg_group #yaxis").getBoundingClientRect().width,e=document.querySelector("#"+b.selector+"_svg_group #yaxis").getBoundingClientRect().height,g=f.mediator.publish("createGroup",b,c,0,0,"yaxis_title");g.attr({transform:"translate("+(-d-b.yAxisTitleFontSize)+","+e/2+")rotate(270)"}),g.append("text").attr({fill:b.yAxisTitleFontColor,"font-family":b.yAxisTitleFontFamily,"font-weight":b.yAxisTitleFontWeight,"fill-opacity":b.yAxisTitleOpacity/100,align:"center","text-anchor":"middle"}).style({"font-size":b.yAxisTitleFontSize}).text(b.yAxisTitle)}},h=function(a,b){if(f.chart_options[a].enableLiveData&&"completed"===f.chart_status[a].status){var c=document.querySelector("#"+a+"_live_data_status"),d=f.chart_options[a],e=f.chart_configs[a];if(c)document.querySelector("#"+a+"_live_data_status").innerHTML!==b&&document.querySelector("#"+a+"_live_data_status").innerHTML!==" "+b&&(document.querySelector("#"+a+"_live_data_status").innerHTML=b);else{var g=d3.select("#"+d.selector+"_svg_group"),h=0;h+=document.querySelector("#"+d.selector+"_svg_group #xaxis")?document.querySelector("#"+d.selector+"_svg_group #xaxis").getBoundingClientRect().height:15,h+=document.querySelector("#"+d.selector+"_svg_group #xaxis_title")?document.querySelector("#"+d.selector+"_svg_group #xaxis_title").getBoundingClientRect().height:15,c=f.mediator.publish("createGroup",d,g,e.width-50,e.height+h,"live_data_status"),c.append("text").attr({id:d.selector+"_live_data_status",fill:d.liveDataStatusFontColor,"font-family":d.liveDataStatusFontFamily,"fill-opacity":d.liveDataStatusOpacity/100,align:"center","text-anchor":"middle"}).style({"font-size":d.liveDataStatusFontSize}).text("")}}},i=function(a,b){if(a.enableGrowthViews){var c,d=f.chart_configs[a.selector],e=a.width-35-140,g=d.previousGroupsHeight;a.showCaption&&(g-=document.getElementById(a.selector+"_svg_caption_group").getBoundingClientRect().height+5),a.showSubCaption,c=f.mediator.publish("createGroup",a,b,e,g,a.selector+"_chart_growth_group"),d3.select("#"+a.selector+"_chart_growth_group").append("text").attr({id:a.selector+"_growth_point_data_value",x:0,y:0,"font-size":a.captionFontSize,"font-family":a.captionFontFamily,"font-weight":a.captionFontWeight,fill:a.captionFontColor,"font-style":a.captionFontStyle}).style({visibility:"hidden"}).text("Data Point"),d3.select("#"+a.selector+"_chart_growth_group").append("text").attr({id:a.selector+"_growth_point_change_value",x:65,y:0,"font-size":a.captionFontSize,"font-family":a.captionFontFamily,"font-weight":a.captionFontWeight,fill:a.captionFontColor,"font-style":a.captionFontStyle}).style({visibility:"hidden"}).text("Data Point"),d3.select("#"+a.selector+"_chart_growth_group").append("text").attr({id:a.selector+"_growth_point_data_label",x:0,y:14,"font-size":a.subCaptionFontSize,fill:a.subCaptionFontColor,"font-family":a.subCaptionFontFamily,"font-weight":a.subCaptionFontWeight,"font-style":a.subCaptionFontStyle}).style({visibility:"hidden"}).text("Growth Point"),d3.select("#"+a.selector+"_chart_growth_group").append("text").attr({id:a.selector+"_growth_point_change_label",x:65,y:14,"font-size":a.subCaptionFontSize,fill:a.subCaptionFontColor,"font-family":a.subCaptionFontFamily,"font-weight":a.subCaptionFontWeight,"font-style":a.subCaptionFontStyle}).style({visibility:"hidden"}).text("Growth Point"),a.showCaption||(d.previousGroupsHeight+=document.getElementById(a.selector+"_growth_point_data_value").getBoundingClientRect().height+4),a.showSubCaption||(d.previousGroupsHeight+=document.getElementById(a.selector+"_growth_point_data_label").getBoundingClientRect().height+6),d3.select("#"+a.selector+"_svg").append("line").attr({id:"header_bottom_border",x1:0,y1:d.previousGroupsHeight,x2:a.width,y2:d.previousGroupsHeight}).style({stroke:"lightgrey","stroke-width":"0.5px"}),d3.select("#"+a.selector+"_svg").append("line").attr({id:a.selector+"_vertical_line",x1:a.width-d.previousGroupsHeight,y1:0,x2:a.width-d.previousGroupsHeight,y2:d.previousGroupsHeight}).style({stroke:"lightgrey","stroke-width":"0.5px"})}};return f.mediator.subscribe("addCaption",a),f.mediator.subscribe("addSubCaption",b),f.mediator.subscribe("createMarker",c),f.mediator.subscribe("xAxisTitle",d),f.mediator.subscribe("yAxisTitle",g),f.mediator.subscribe("liveDataStatus",h),f.mediator.subscribe("updateXAxisRange",e),f.mediator.subscribe("createGrowthViewsGroup",i),{addCaption:a,addSubCaption:b}}(),f.svgRendererFunctions=function(){var b=function(a){var b=d3.select("#"+a.selector).append("svg").attr({width:a.width,height:a.height,id:a.selector+"_svg","data-width":a.width,"data-height":a.height,preserveAspectRatio:"none",viewBox:"0 0 "+a.width+" "+a.height
}).style({display:"block","background-color":a.bgColor});return b},c=function(a,b,c,d,e){var f=b.append("g").attr({id:e,transform:"translate("+c+","+d+")"});return f},d=function(a,b){var c=a[b]?!1:!0,d=a[b]&&"number"!=typeof a[b]?a[b].indexOf("%"):-1;return-1!==d&&(a[b]=a[b].substring(0,d),c=!0),c},e=function(b,c){var d,e,g,h,i=document.getElementById(b.selector),j=(f.chart_configs[b.selector],i.style[c]),k=window.getComputedStyle(i,null);switch(c){case"width":g=parseFloat(k.getPropertyValue("padding-left"))+parseFloat(k.getPropertyValue("padding-right")),d=i.clientWidth;break;case"height":g=parseFloat(k.getPropertyValue("padding-top"))+parseFloat(k.getPropertyValue("padding-bottom")),d=i.clientHeight;break;default:g=0}if(e=j||d,h=d-g,"width"!==c||e){if("height"===c&&!h)return a("For Chart Selector '"+b.selector+"': Please provide the height to the parent container of the svg or specify the height of the svg in px"),!1}else i.style[c]="100%",d=i.clientWidth;return d*(parseFloat(b[c])/100)-g};return f.mediator.subscribe("createSVG",b),f.mediator.subscribe("createGroup",c),f.mediator.subscribe("calculateSVGDimensions",e),f.mediator.subscribe("checkIfDimensionInPecentage",d),{createSVG:b,createGroup:c}}(),f.xAxisFunctions=function(){var a=function(a,b){return d3.time.scale().domain(a).range(b)},c=function(a,b,c,d){var e=b.append("g").attr({id:"xaxis","class":"x axis",transform:"translate("+c+","+d+")"});return e},d=function(a,b){var c=g(a.selector,a.xAxisTickValues),d=k(a.xAxisTickIntervalGranularity),e=f.dateFormatFunctions.dateFormatter,h=f.numberFormatFunctions.numberFormatter,i=f.chart_configs[a.selector].xAxisTickValuesFormat,j=d3.svg.axis().scale(b).orient(a.xAxisPosition).ticks(a.xAxisNoOfTicks).tickSize(a.xAxisTickSize).tickValues(c).tickPadding(a.xAxisTickPadding).tickFormat(function(b,c){return i?h(i,b):a.xAxisTickValuesFormat.constructor===Function?a.xAxisTickValuesFormat(b,c):e(a.xAxisTickValuesFormat,b)}).outerTickSize(a.xAxisOuterTickSize);return d.d3Time&&j.ticks(d.d3Time,a.xAxisTickInterval),j},e=function(a){d3.selectAll("#"+a.selector+"_svg_group .x.axis text").style({"font-size":a.xAxisTickValueSize+"px","font-weight":a.xAxisTickValueStyle,"font-family":a.xAxisTickValueFontFamily,fill:a.xAxisTickValueColor}),d3.selectAll("#"+a.selector+"_svg_group .x.axis path").style({stroke:a.xAxisLineColor,"stroke-width":a.xAxisLineThickness+"px",opacity:a.xAxisLineOpacity}),d3.selectAll("#"+a.selector+"_svg_group .x.axis line").style({stroke:a.xAxisTickColor,opacity:a.xAxisTickOpacity,"stroke-width":a.xAxisTickThickness})},g=function(a,c){if("smartDefault"===c||void 0===c||0===c.length)return null;if(f.chart_options[a]&&"column"===f.chart_options[a].chartType)return c;var d,e,g=[],h=c.length;for(d=0;h>d;d++)e=f.mediator.publish("detectDateFormat",a,[{x:c[d]}],"x"),f.validation.dataTypes(c[d],"date")&&"Invalid format"!==e.format?g.push(c[d]):b(f.errors.invalidConfig("xAxisTickValue: "+c[d]+" invalid date type",a));return g},h=function(a,b){var c=f.chart_configs[a],d=f.chart_options[a],e=(g(d.xAxisTickValues),d3.svg.axis().scale(b).orient(d.xAxisPosition).ticks(d.xAxisNoOfTicks).tickSize(-c.height).tickFormat("").outerTickSize(0));return e},i=function(a,b,c){var d=a.append("g").attr({id:"xaxis_grid","class":"x grid",transform:"translate("+b+","+c+")"});return d},j=function(a){d3.selectAll("#"+a.selector+"_svg_group .x.grid line").style({stroke:a.gridColor,opacity:a.gridOpacity/100})},k=function(a){switch(a){case"second":return{d3Time:d3.time.second,format:"%S"};case"minute":return{d3Time:d3.time.minute,format:"%M"};case"hour":return{d3Time:d3.time.hour,format:"%H"};case"day":return{d3Time:d3.time.day,format:"%d"};case"month":return{d3Time:d3.time.month,format:"%b"};case"year":return{d3Time:d3.time.year,format:"%Y"};default:return{d3Time:null,format:null}}};return{scale:a,createAxisGroup:c,axis:d,setCSSConfigs:e,validateTickValues:g,createGrid:h,createGridGroup:i,setGridCSS:j,intervalGranularity:k}}(),f.yAxisFunctions=function(){var a=function(a,b){var c=g(a.selector,a.yAxisTickValues),d=a.yAxisTickFormat,e=f.chart_configs[a.selector],h=e.yAxisTickValuesFormat,i=f.numberFormatFunctions.numberFormatter;return h?d=function(a){return e.numbersuffix?i(h,a)+e.numbersuffix:i(h,a)}:d&&d.constructor===Function||(d="smartDefault"===d||void 0===d?null:function(b){return i(a.yAxisTickFormat,b)}),d3.svg.axis().scale(b).orient(a.yAxisPosition).ticks(a.yAxisNoOfTicks).tickSize(a.yAxisTickSize).tickFormat(d).tickValues(c).outerTickSize(a.yAxisOuterTickSize)},c=function(a,b,c,d){var e=b.append("g").attr({id:"yaxis","class":"y axis",transform:"translate("+c+","+d+")"});return e},d=function(a,b){return d3.scale.linear().domain(a).range(b)},e=function(a){d3.selectAll("#"+a.selector+"_svg_group .y.axis text").style({"font-size":a.yAxisTickValueSize+"px","font-weight":a.yAxisTickValueStyle,"font-family":a.yAxisTickValueFontFamily,fill:a.yAxisTickValueColor}),d3.selectAll("#"+a.selector+" .y.axis path").style({stroke:a.yAxisLineColor,"stroke-width":a.yAxisLineThickness+"px",opacity:a.yAxisLineOpacity}),d3.selectAll("#"+a.selector+" .y.axis line").style({stroke:a.yAxisTickColor,opacity:a.yAxisTickOpacity,"stroke-width":a.yAxisTickThickness})},g=function(a,c){if(c&&c.constructor===Function)return c;if("smartDefault"===c||void 0===c||0===c.length)return null;var d,e=[],g=c.length;for(d=0;g>d;d++)f.validation.dataTypes(c[d],"number")?e.push(c[d]):b(f.errors.invalidConfig("yAxisTickValue: "+c[d],a));return e},h=function(a,b){var c=f.chart_configs[a],d=f.chart_options[a],e=(g(a,d.yAxisTickValues),d3.svg.axis().scale(b).orient(d.yAxisPosition).ticks(d.yAxisNoOfTicks).tickSize(-c.width).tickFormat("").outerTickSize(0));return e},i=function(a,b,c){var d=a.append("g").attr({id:"yaxis_grid","class":"y grid",transform:"translate("+b+","+c+")"});return d},j=function(a){d3.selectAll("#"+a.selector+"_svg_group .y.grid line").style({stroke:a.gridColor,opacity:a.gridOpacity/100})};return{scale:d,createAxisGroup:c,axis:a,setCSSConfigs:e,validateTickValues:g,createGrid:h,createGridGroup:i,setGridCSS:j}}(),f.crosshair=function(){var a=function(a,b){document.getElementById(b)||d3.select("body").append("div").attr({id:b,"class":"comcharts-TS-tooltip_div"}).style({"border-width":a.tooltipBorderBodyWidth,"border-radius":a.tooltipBorderBodyRadius,"border-style":a.tooltipBorderBodyStyle,"border-color":a.tooltipBorderBodyColor,"background-color":a.tooltipBgBodyColor,opacity:a.tooltipBgBodyOpacity/100,"font-size":a.tooltipBodyFontSize,"font-family":a.tooltipBodyFontFamily,"font-weight":a.tooltipBodyFontWeight,color:a.tooltipBodyFontColor,"z-index":1e3,display:a.tooltipBodyDisplay})},b=function(a,b,c){a.style({top:b+"px",left:c+"px"})},c=function(a,b){d3.select("#"+a).html(b)},d=function(a,b,c,d){var e="";return e+=tooltipTextBody(a,b,c,d)};return f.mediator.subscribe("createTooltip",a),f.mediator.subscribe("renderTooltipContent",c),f.mediator.subscribe("toolTipPosition",b),f.mediator.subscribe("tooltipText",d),{createTooltip:a}}(),f.columnChartOrdinalFunctions=function(){var a=function(a){var b,c,d,e,g,h=f.xAxisFunctions,i=f.yAxisFunctions,j=[],k=[],l=f.chart_configs[a.selector];k[0]="right"===a.yAxisPosition?a.width-a.marginLeft-a.marginRight:0,k[1]=0,l.previousGroupsHeight=0,b=f.mediator.publish("createSVG",a),f.mediator.publish("addCaption",a,b),f.mediator.publish("addSubCaption",a,b),c=f.mediator.publish("createGroup",a,b,a.marginLeft,a.marginTop,a.selector+"_svg_group"),g=f.mediator.publish("createGroup",a,c,k[0],k[1],a.selector+"_plot_group"),a.showXAxis&&(j[0]=0,j[1]="bottom"===a.xAxisPosition?a.height-a.marginTop-a.marginBottom:0,d=h.createAxisGroup(a,c,j[0],j[1])),a.showYAxis&&(e=i.createAxisGroup(a,c,k[0],k[1]))},b=function(a,b,c){var d,e,g,h,i,j,k,l,m=f.xAxisFunctions,n=f.yAxisFunctions,o=a.height-a.marginTop-a.marginBottom,p=a.width-a.marginLeft-a.marginRight,q=[],r=[],s=a.metricsColumnName,t=a.selector,u=f.chart_configs[a.selector],v=(a.dateColumnName,a.metricsColumnName[0],{sort:{asc:"dataquerykey"}}),w=(a.interaction,f.dateFormatFunctions.dateFormatter);c||("object"==typeof s?(v.filter={column:s.seriesColumnName,condition:"Equal",values:s.seriesName},b=f.Query.getData(t,s.seriesColumnName,v)):b=f.Query.getData(t,s,v)),u.height=o,u.width=p,q[0]=d3.min(b,function(a){return a.key}),q[1]=d3.max(b,function(a){return a.key}),r[0]=0,r[1]=d3.max(b,function(a){return+a.value}),u.svg=g=d3.select("#"+a.selector+"_svg"),u.group=h=d3.select("#"+a.selector+"_svg_group"),u.xGroup=i=d3.select("#"+a.selector+"_svg_group #xaxis"),u.yGroup=j=d3.select("#"+a.selector+"_svg_group #yaxis"),u.xScale=xScale=m.scale(q,[0,p]),u.yScale=yScale=n.scale(r,[o,0]),u.yAxis=e=n.axis(a,yScale);var x=d3.scale.ordinal().domain(b.map(function(a,b){return new Date(a.key)})).rangeRoundBands([0,p],.1);u.fakeOrdinanalScale=x,u.xAxis=d=m.axis(a,x),d.tickFormat(function(b,c){return a.xAxisTickValuesFormat.constructor===Function?a.xAxisTickValuesFormat(b,c):w(a.xAxisTickValuesFormat,b)}),k=d3.select("#"+a.selector+"_plot_group"),u.column=l=k.selectAll(".column").data(b),l.exit().remove(),l.enter().append("rect").attr("class","column"),l.style("fill",function(){return a.isTimeNavigator?"url(#"+t+"_gradient)":a.chartColor[0]}).style("stroke-width",a.borderThickness).style("stroke",a.bordercolor).attr("x",function(a){return x(new Date(a.key))}).attr("width",x.rangeBand()).transition().duration(1e3*a.chartTransitionSpeed).attr("y",function(a){return a.value?yScale(a.value):0}).attr("height",function(a){return a.value?o-yScale(+a.value):0}),k.attr("clip-path","url(#"+a.selector+"_clip)"),f.mediator.publish("createOverlay",k,p,o,a),i.call(d),j.call(e),m.setCSSConfigs(a),n.setCSSConfigs(a),f.mediator.publish("xAxisTitle",a.selector),f.mediator.publish("yAxisTitle",a.selector)};return f.mediator.subscribe("renderColumnChart",a),f.mediator.subscribe("columnChartOrdinal",b),{columnChart:b}}(),f.modal=function(){var a=d3.dispatch("click");f.clubFeaturesInModal={edit:["impactSwitch","smoothing","anomalyDetection","viewRawData","growthViews"],timeNavigator:["timeNavigator"],smoothing:["impactSwitch","smoothing","anomalyDetection","viewRawData","growthViews"],anomalyDetection:["impactSwitch","smoothing","anomalyDetection","viewRawData","growthViews"]},f.featureAlias={viewRawData:{alias:"Chart",show_status:!1},timeNavigator:{alias:"Chart",show_status:!1},smoothing:{alias:"Reduce Noise",show_status:!0},anomalyDetection:{alias:"Detect Anomalies",show_status:!0},impactSwitch:{alias:"Filters",show_status:!0},growthViews:{alias:"Growth Views",show_status:!0}};var b=function(a){console.log("modal init"),this.closeButton=null,this.modal=null,this.overlay=null,this.transitionEnd=j();var b={autoOpen:!1,className:"fade-and-drop",closeButton:!0,content:"",overflow:"hidden",overlay:!0};"iOS"===a.modal_type?(b.minWidth="80%",b.maxWidth="80%",b.minHeight="80%",b.maxHeight="80%",b.top="10%",b.left="10%"):(b.minWidth="50%",b.maxWidth="50%",b.minHeight="50%",b.maxHeight="50%",b.top="25%",b.left="25%"),arguments[0]&&"object"==typeof arguments[0]&&(this.options=h(b,arguments[0])),d.call(this)},c=function(a,b){var c,d=this;if(this.modal.className=this.modal.className.replace(" scotch-open",""),this.overlay.className=this.overlay.className.replace(" scotch-open",""),this.modal.addEventListener(this.transitionEnd,function(){d.modal.parentNode.removeChild(d.modal)}),this.overlay.addEventListener(this.transitionEnd,function(){d.overlay.parentNode&&d.overlay.parentNode.removeChild(d.overlay)}),a&&(c=document.getElementById(a+"_svg"),c.setAttribute("width",f.chart_options[a].width+"px"),c.setAttribute("height",f.chart_options[a].height+"px"),document.getElementById(a).appendChild(c)),f.chart_configs[a]){var e=f.chart_configs[a].wasLiveDataPaused;e||f.mediator.publish("resumeLiveData",a+"_cfr"),b&&d3.select("#"+a+"_highlight").style({visibility:"visible",opacity:"0.4"}).transition().duration(800).ease("linear").style({opacity:"0"}).transition().style({visibility:"hidden"})}},d=function(){e.call(this),this.modal.className=this.modal.className+(this.modal.offsetHeight>window.innerHeight?" scotch-open scotch-anchored":" scotch-open"),this.overlay.className=this.overlay.className+" scotch-open",$(".toggle_form_controls").attr({"data-size":"mini","data-on-color":"success","data-handle-width":"20px","data-label-width":"2px"}).bootstrapSwitch()},e=function(){var b,c,d,e,j,l,m,n,o;if(chart_id=this.options.selector,c=document.createDocumentFragment(),this.modal=document.createElement("div"),this.modal.className="scotch-modal "+this.options.className,this.modal.style.top=this.options.top,this.modal.style.left=this.options.left,f.isMobile?this.modal.style.width="80%":(this.modal.style.width="auto",this.modal.style.minWidth=this.options.minWidth,this.modal.style.maxWidth=this.options.maxWidth,this.modal.style.minHeight=this.options.minHeight,this.modal.style.maxHeight=this.options.maxHeight),this.modal.style.overflow=this.options.overflow,this.options.overlay===!0&&(this.overlay=document.createElement("div"),this.overlay.className="scotch-overlay "+this.options.className,this.overlay.addEventListener("click",a.click),c.appendChild(this.overlay)),o=document.createElement("div"),o.className="comcharts-TS-modal-inner-container",this.options.close_text&&(t=document.createElement("div"),t.innerHTML="<span class='comcharts-TS-modal-close'>"+this.options.close_text+"</span>",t.style.textAlign="right",t.style.right="0px",t.style.position="absolute",t.style.zIndex="1002",t.style.right="10px",t.style.top="12px",t.addEventListener("click",a.click),o.appendChild(t)),this.options.modal_title){var p=document.createElement("div");p.innerHTML=this.options.modal_title,p.className="comcharts-TS-modal-chartarea-title",p.style["float"]="none",o.appendChild(p)}switch(this.options.modal_type){case"iOS":var q,r,s,t,u,v,w,x,y,z="",A=f.clubFeaturesInModal[this.options.feature_name],B=A.length,C="";for(q=document.createElement("div"),q.className="col-sm-2 comcharts-TS-modal-feature-list",r=document.createElement("div"),f.chart_options[this.options.selector].isTimeNavigator?(this.modal.style.top="20%",this.modal.style.left="20%",this.modal.style["min-width"]="60%",this.modal.style["max-width"]="60%",this.modal.style["min-height"]="30%",this.modal.style["max-height"]="60%",r.className="col-sm-12 comcharts-TS-feature-container"):r.className="col-sm-10 comcharts-TS-feature-container",s=document.createElement("div"),s.innerHTML="Settings",s.className="comcharts-TS-modal-title",z+='<ul id="myTabs" class="nav nav-pills nav-stacked comcharts-TS-modal-feature" role="tablist">',u=document.createElement("div"),u.id="myTabContent",u.className="tab-content",w=0;B>w;w++)each_feature_in_modal=A[w],alias=f.featureAlias[each_feature_in_modal].alias,("timeNavigator"===each_feature_in_modal||f.chartToFeatureMapping[this.options.selector]&&f.chartToFeatureMapping[this.options.selector].indexOf(each_feature_in_modal)>-1)&&(h(this.options,f.mediator.publish(each_feature_in_modal+"Modal",this.options.parameters)),b=this.options.content||"",e=document.createElement("div"),e.className="vm-modal-body","string"==typeof b?e.innerHTML+=b:e.appendChild(b),j=document.createElement("div"),j.className="vm-modal-buttons",window.opt=this.options,this.options.apply_id&&(l=document.createElement("div"),l.id=this.options.apply_id,l.className="apply-button deactive",l.appendChild(document.createTextNode("Apply")),l.addEventListener("click",function(){opt.callbacks&&opt.callbacks.afterApply&&(y=opt.callbacks.afterApply),f.mediator.publish(this.id.split("_apply_")[1]+"OnClick",chart_id,y),f.mediator.publish("closeModal",options.selector)}),j.appendChild(l)),this.options.description&&!f.isMobile&&(m=document.createElement("div"),m.className="vm-modal-subtitle",m.appendChild(document.createTextNode(this.options.description))),n=document.createElement("div"),n.style.clear="both",C=this.options.selected_tab===each_feature_in_modal?" active":"",x=f.featureAlias[each_feature_in_modal].show_status?f.chart_configs[this.options.selector].feature_status[each_feature_in_modal]?"On":"Off":"",z+='<li role="presentation" class="'+C+'"><a href="#'+each_feature_in_modal+'_tab_content"id="'+each_feature_in_modal+'-tab"role="tab" data-toggle="tab"aria-controls="'+each_feature_in_modal+'"aria-expanded="true">'+alias+'<span class="feature_status">'+x+"</span></a></li>",v=document.createElement("div"),v.id=each_feature_in_modal+"_tab_content",v.className="tab-pane fade in"+C,v.role="tabpanel",v["aria-labelledby"]=each_feature_in_modal+"-tab",v.appendChild(e),v.appendChild(j),v.appendChild(n),u.appendChild(v));z+="</ul>",d3.select(q).html(z),r.appendChild(u),f.chart_options[this.options.selector].isTimeNavigator||o.appendChild(q),o.appendChild(r),this.modal.appendChild(o);break;case"custom":var D=this.options.apply_text||"Apply";d=k(this.options.apply,this.options.apply_on,this.options.help_id?this.options.help_id:"modal_help",this.options.help_text,this.options.suffix?this.options.suffix:"",this.options.type),b=this.options.content||"",e=document.createElement("div"),e.className="vm-modal-body",this.options.modalBodyClassName&&(e.className+=" "+this.options.modalBodyClassName),"string"==typeof b?e.innerHTML+=b:e.appendChild(b),j=document.createElement("div"),j.className="vm-modal-buttons",this.options.buttonsClass&&(j.className+=" "+this.options.buttonsClass),this.options.apply_id&&(l=document.createElement("div"),l.id=this.options.apply_id,l.className="apply-button deactive",l.appendChild(document.createTextNode(D)),j.appendChild(l)),this.options.description&&!f.isMobile&&(m=document.createElement("div"),m.className="vm-modal-subtitle",m.appendChild(document.createTextNode(this.options.description))),n=document.createElement("div"),n.style.clear="both",this.options.apply&&o.appendChild(d),this.options.description&&!f.isMobile&&o.appendChild(m),o.appendChild(e),o.appendChild(j),o.appendChild(n),this.modal.appendChild(o)}c.appendChild(this.modal),document.body.appendChild(c),"iOS"===this.options.modal_type&&($('a[data-toggle="tab"]').on("shown.bs.tab",function(a){var b=a.target.id.split("-")[0];g(chart_id,b)}),document.querySelector(".scotch-modal .comcharts-TS-feature-container").style.minHeight=document.querySelector(".scotch-modal").getBoundingClientRect().height+"px",d3.selectAll(".scotch-modal .comcharts-TS-modal-chartarea").style("min-height",document.querySelector(".scotch-modal").getBoundingClientRect().height+"px")),f.chart_options[this.options.selector]&&f.chart_options[this.options.selector].isTimeNavigator&&document.querySelector(".comcharts-TS-modal-non-chartarea.comcharts-TS-modal-non-chartarea-TN")&&(document.querySelector(".comcharts-TS-modal-non-chartarea.comcharts-TS-modal-non-chartarea-TN").style.height=document.querySelector(".scotch-modal").getBoundingClientRect().height+"px");var E;document.getElementById(this.options.selector+"_anomaly_detection_series_div")&&(E=document.querySelector(".scotch-modal").offsetHeight-document.querySelector(".comcharts-TS-content-sub-heading").offsetHeight-document.querySelector(".comcharts-TS-category-modal").offsetHeight-140,document.getElementById(this.options.selector+"_anomaly_detection_series_div").style.height=E+"px"),document.getElementById(this.options.selector+"_smoothing_series_div")&&(E=document.querySelector(".scotch-modal").offsetHeight-document.querySelector(".comcharts-TS-content-sub-heading").offsetHeight-document.querySelector(".comcharts-TS-category-modal").offsetHeight-140,document.getElementById(this.options.selector+"_smoothing_series_div").style.height=E+"px"),document.getElementById(this.options.selector+"_TN_series_div")&&(E=document.querySelector(".modal-body-content").offsetHeight-document.querySelector(".comcharts-TS-modal-chartarea-title").offsetHeight-80,document.getElementById(this.options.selector+"_TN_series_div").style.height=E+"px"),i(this.options,this.options.modal_type)},g=function(a,b){var c,d,e,f=document.getElementById(a+"_svg"),g=parseInt(f.getAttribute("data-height")),h=parseInt(f.getAttribute("data-width")),i=document.querySelector(".scotch-modal").getBoundingClientRect().height,j=document.getElementById(b+"_modal_chartarea");d=g>i&&i>0?i:g,j&&(e=j.offsetWidth,console.log(h,e),c=h>e&&e>0?e:h,console.log(d,"height"),f.setAttribute("width",c+"px"),f.setAttribute("height",d+"px"),j.appendChild(f))},h=function(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},i=function(b,c){b.callbacks&&b.callbacks.afterOpen&&b.callbacks.afterOpen(b.selector),a.on("click.modal-close",function(){"iOS"===c?f.mediator.publish("closeModal",b.selector||b.parameters.selector):f.mediator.publish("closeModal"),b.callbacks&&b.callbacks.afterClose&&b.callbacks.afterClose(b.selector)}),document.onkeydown=function(b){b=b||window.event,27==b.keyCode&&a.click()}},j=function(){var a=document.createElement("div");return a.style.WebkitTransition?"webkitTransitionEnd":a.style.OTransition?"oTransitionEnd":"transitionend"},k=function(a,b,c,d,e,g){var h=document.createElement("div");return h.className="vm-modal-heading",h.innerHTML="<div class='comcharts-TS-vm-modal-heading-div'>",f.isMobile&&"undefined"!=typeof d&&(h.innerHTML+="<span id ='"+c+"' class='modal-help'>"+d+"</span>"),h.innerHTML+="</div><div></div><span class='modal-title-bold'>"+a+"</span>",b&&(f.isMobile||"feature"!==g?"feature"===g?h.innerHTML+="<div class='for'> for "+b+"</div>":"help_individual"===g&&(h.innerHTML+="<span class='for'>"+b+"</span><span class='for'>"+e+"</span>"):h.innerHTML+="<span class='for'> for </span><span class='for'>"+b+"</span>"),h},l=function(a,b,c){var d=document.createElement("div");return d.className="when-loading",d.innerHTML="<div class='loader-div'><div id='preloader_1'><span></span><span></span><span></span><span></span><span></span></div><br><div class='applying-text'>"+a+"</div></div>",d.style.width=b+"px",d.style.height=c+"px",d};return f.mediator.subscribe("initModal",b),f.mediator.subscribe("renderModal",i),f.mediator.subscribe("openModal",d),f.mediator.subscribe("closeModal",c),f.mediator.subscribe("createLoader",l),f.mediator.subscribe("extendDefaults",h),{init:b,open:d,close:c}}(),Date.prototype.getWeek=function(){var a=new Date(this.getFullYear(),0,1);return Math.ceil(((this-a)/864e5+a.getDay()+1)/7)},f.dimensionalAnalysis=function(){var a,b,c,d,g={},i=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,[{granularity:"year"},{granularity:"quarter",length:4},{granularity:"month",length:12},{granularity:"week",length:53},{granularity:"day",length:31},{granularity:"weekday",length:7},{granularity:"hour",hour:24}]),j=["year","quarter","month","week","day","weekday","hour"],k=4,l={},m=[void 0],n="#42A5F5",o="#F44336",p=function(a,b){var c=a.dateColumnName;f.Query.setQuery(a.selector,"dimensionFilterDatesQuery",{dimension:[{dates:function(a){return a[c]}}]})},q=function(a){var b,c;for(var d in a)if(null!==a[d])switch(c=a[d][0],d){case"year":b=function(a){return new Date(a).getFullYear()==c};break;case"month":b=function(a){return new Date(a).getMonth()==c};break;case"day":b=function(a){return new Date(a).getDate()==c};break;case"week":b=function(a){return new Date(a).getWeek()==c};break;case"hour":b=function(a){return new Date(a).getHours()==c};break;case"weekday":b=function(a){return new Date(a).getDay()==c};break;case"quarter":b=function(a){return parseInt(new Date(a).getMonth()/3)+1==c}}return b},r=function(a){return q(a)},s=function(a,b){f.Query.addFilter(b.selector,"dimensionFilterDatesQuery",[{column:"dates",condition:"Eval",values:r(a)}])},t=function(a,b,c){var d,e,g,h;if(a.isGlobalData){for(g=f.gChart_to_data_set_mapping[a.selector],h=g.length,d=0;h>d;d++)if("complete"!==f.data_load_status[g[d]].status)return;e=g.length}var i,j,k,l,m,n={};if(b=b||[],f.chart_configs[a.selector]=f.chart_configs[a.selector]||{},f.chart_configs[a.selector].feature_status={},l=f.chart_configs[a.selector],a=f.mediator.publish("validate",a,f["default"].mandatory_configs)){for(d3.select("#"+a.selector)[0][0].className+=" chart-div",a=f.mediator.publish("validate",a,f["default"].chart_features),a=f.mediator.publish("validate",a,f["default"].chart_options),f.chart_options[a.selector]={},f.chart_options[a.selector]=a,f.chart_status[a.selector]=f.chart_status[a.selector]||{status:!1,onComplete:[]},k=f.chart_configs[a.selector].featuresApplied={},j=a.metricsColumnName,i=j.length,d=0;i>d;d++)k[j[d].replace(/[\(\)\!\@\#\$\%\^\&\*\+\=\[\]\{\}\;\'\:\"\|, \.]*/gi,"")]=[];n.options=a,m=document.getElementById(a.selector),m.style.outline="none",a.isGlobalData?(f.chart_status[a.selector].status="inprogress",f.mediator.publish("dimensionalAnalysisConfigCallback",{options:a},JSON.parse(JSON.stringify(a.globalData)),b,c),f.chart_options[a.selector].globalData=null,a.globalData=null):f.mediator.publish("parseData",a.data,"dimensionalAnalysisConfigCallback",n,b,c)}},u=function(a,b,c,d){var g,h,i,j=a.options.selector,k=j+"_cfr",l=a.options,m=f.chart_configs[j],n=f.chart_status[j].status;if(b=b||f.Query.getData(k,"query_cfr"),h=e(l,b[0])){if(console.time(l.selector+"dimensionalAnalysisConfigCallback"),!m.refresh_process_initiated){m.live_data_length=0,g=l.dateColumnName;var o=(l.processMissingDataPoint,f.mediator.publish("detectDateFormat",j,b,g)),p=o.format_data,q=o.format;l.inputDateFormat=o,m.data_processed=f.mediator.publish("dataProcessing",b,g,p,q,l),f.Query.init(k,m.data_processed.data),f.Query.setQuery(k,"query_cfr",{dimension:[g]}),f.Query.init(j,m.data_processed.data),w(l,d),i=f.Query.getData(k,"query_cfr")}console.timeEnd(l.selector+"dimensionalAnalysisConfigCallback"),m.all_data_length=b.length,f.mediator.publishToAll(c),"inprogress"===n&&(f.chart_status[j].status="completed",f.mediator.publish("executeOnComplete",j,"chart"))}},v=function(a,b,c,d){document.querySelector("#"+d.selector+"_overlay")||a.append("rect").attr("id",d.selector+"_overlay").attr("class","overlay").attr("width",b).attr("height",c)},w=function(a,b){var c,d,e,g,h=a.selector,i=a.dateColumnName,j=h+"_cfr",k=a.metricsColumnName,l=k.length,m=a.newMetricsColumn;for(e=0;l>e;e++)g=k[e],"object"==typeof g?f.Query.deleteQuery(h,g.seriesColumnName):f.Query.deleteQuery(h,m[e]);for(e=0;l>e;e++)if(g=k[e],c={},d={},d[j]="query_cfr","object"==typeof g){var n=JSON.parse(JSON.stringify(g));c[n.metric]="sum",f.query_data[h][n.seriesColumnName]||f.Query.setQuery(h,n.seriesColumnName,{dimension:[{date_field_name:function(a){return a[i]+"||"+a[n.seriesColumnName]}}],metric:[c],data_impacted_by:[d]})}else c[g]="sum",f.Query.setQuery(h,m[e],{metric:[c],dimension:[i],data_impacted_by:[d]})},x=function(a,b,c){console.time("onComplete");var d,e;switch(b){case"chart":d=f.chart_status[a].onComplete;break;case"data":for(d=f.data_load_status[a].onComplete,e=0;e<d.length;e++)d[e].attribute[0].globalData=c}f.mediator.publishToAll(d),console.timeEnd("onComplete")},y=function(a){var b,c=a.selector,d=a.selector,e=f.chart_options[c],g=(f.chart_configs[c],document.createElement("div"),document.createElement("div"),document.createElement("div"),e.metricsColumnName);g.length,f.Query.getData(e.selector+"_cfr","query_cfr",{filter:{column:"isRawData",condition:"Equal",values:!0}}),e.newMetricsColumn;b={tooltipBgBodyOpacity:100,tooltipBgBodyColor:"white"},f.mediator.publish("createTooltip",b,"dimensional_analysis_chart_tooltip"),S(d,c),reset_all_button=I(),document.getElementById("DA_highlight_view").appendChild(reset_all_button),document.getElementById("dimensional_analysis_chart_tooltip").style["z-index"]=10200},z=function(a,b,c,d,e){var g=document.createElement("div"),h=(document.createElement("div"),document.createElement("div")),i=document.createElement("div"),j=(f.allCharts,document.createElement("div")),k=document.createElement("div"),l=(document.createElement("div"),document.createElement("h3"),document.createElement("div")),m=document.createElement("div");j.id="panel_header_container",j.className="comcharts-TS-da-header-container",k.id="chart_header",l.innerHTML="x",l.id="remove_panel",l.addEventListener("click",function(){main_DA_container=document.getElementById("dimensionalAnalysis"),panel=document.createElement("div"),panel.id="DA_panel_"+d,panel.className="col-sm-4 comcharts-TS-da-tab",main_DA_container.insertBefore(panel,document.getElementById("comchart_TS_clearfix")),document.getElementById(panel.id).innerHTML="",Q(panel.id,!1,a)}),m.className="comcharts-TS-clearfix",g.id="panel_DA_dashboard_"+d+"_select_box",g.className="comcharts-TS-da-dashboard-box",g.innerHTML=f.chart_options[a].caption||"Filter by time",i=document.createElement("div"),i.appendChild(g),k.appendChild(i);var n=f.chart_options[a].newMetricsColumn,o=f.chart_options[a].displayMetricsColumn;return h.id="panel_DA_series_"+d+"_select_box",h.className="comcharts-TS-da-series-box",h.style["max-width"]="100%",h.setAttribute("panel-id",d),h.innerHTML=o[n.indexOf(b)],h.addEventListener("click",function(){panel_body=R(c),f.mediator.publish("initModal",{content:panel_body,modal_title:'Select a series to "Roll-up by time"',close_text:"x",close_id:"DA_close_select_series",modal_type:"custom",selected_tab:"DA_panel_"+d,maxHeight:"65%",top:"20%"})}),i.appendChild(h),k.appendChild(i),j.appendChild(k),j.appendChild(l),j.appendChild(m),j},A=function(a,b,c,d,e){var f="DA_panel_"+d;B(a,b,c,f,d,e)},B=function(a,b,c,d,e,g){var h,i,j,k,l=document.getElementById(d),m=f.chart_options[c],n=f.Query.getData(c+"_cfr","query_cfr",{filter:{column:"isRawData",condition:"Equal",values:!0}});l&&!document.getElementById(d+"_dimensional_analysis_holder")&&(h=document.createElement("div"),h.id=d+"_"+c+"_dimensional_analysis_holder",1!=e||document.getElementById("DA_panel_2")?2!=e||document.getElementById("DA_panel_3")||(k=document.getElementById("dimensionalAnalysis"),j=document.createElement("div"),j.id="DA_panel_3",j.className="col-sm-4 comcharts-TS-da-tab",k.insertBefore(j,document.getElementById("comchart_TS_clearfix")),Q("DA_panel_3",!1,c)):(k=document.getElementById("dimensionalAnalysis"),i=document.createElement("div"),i.id="DA_panel_2",i.className="col-sm-4 comcharts-TS-da-tab",k.insertBefore(i,document.getElementById("comchart_TS_clearfix")),Q("DA_panel_2",!1,c)),h.id=d+"_dimensional_analysis_holder",l.appendChild(h)),C(a,b,c,d,n,g),p({selector:c+"_DA",dateColumnName:m.dateColumnName},n)},C=function(a,b,c,d,e,g){var h=f.chart_options[c];e=e||f.Query.getData(c+"_cfr","query_cfr",{filter:{column:"isRawData",condition:"Equal",values:!0}}),document.getElementById(d+"_dimensional_analysis_holder").innerHTML="",D(h,e,b,"sum",g),G(a,b,h,d,g)},D=function(a,b,c,d,e){console.time("metric+dimnsion");var g={},h=f.Query,i=a.dateColumnName;if(e.metric)g[e.metric]=d;else{var j=a.metricsColumnName[a.newMetricsColumn.indexOf(c)];g[j]=d}h.init(a.selector+"_DA",b),h.setQuery(a.selector+"_DA","DA_year",{dimension:[{year:function(a){return"object"==typeof c?new Date(+a[i]).getFullYear()+"||"+a[c.seriesColumnName]:new Date(+a[i]).getFullYear()}}]}),h.setQuery(a.selector+"_DA","DA_month",{dimension:[{month:function(a){return"object"==typeof c?new Date(+a[i]).getMonth()+"||"+a[c.seriesColumnName]:new Date(+a[i]).getMonth()}}]}),h.setQuery(a.selector+"_DA","DA_day",{dimension:[{day:function(a){return"object"==typeof c?new Date(+a[i]).getDate()+"||"+a[c.seriesColumnName]:new Date(+a[i]).getDate()}}]}),h.setQuery(a.selector+"_DA","DA_hour",{dimension:[{hour:function(a){return"object"==typeof c?new Date(+a[i]).getHours()+"||"+a[c.seriesColumnName]:new Date(+a[i]).getHours()}}]}),h.setQuery(a.selector+"_DA","DA_weekday",{dimension:[{weekday:function(a){return"object"==typeof c?new Date(+a[i]).getDay()+"||"+a[c.seriesColumnName]:new Date(+a[i]).getDay()}}]}),h.setQuery(a.selector+"_DA","DA_week",{dimension:[{week:function(a){return"object"==typeof c?new Date(+a[i]).getWeek()+"||"+a[c.seriesColumnName]:new Date(+a[i]).getWeek()}}]}),h.setQuery(a.selector+"_DA","DA_quarter",{dimension:[{quarter:function(a){return"object"==typeof c?parseInt(new Date(+a[i]).getMonth()/3)+1+"||"+a[c.seriesColumnName]:parseInt(new Date(+a[i]).getMonth()/3)+1;
}}]}),console.timeEnd("metric+dimnsion"),console.time("metric"),h.createMetric(a.selector+"_DA","DA_year",{metric:[g]}),h.createMetric(a.selector+"_DA","DA_month",{metric:[g]}),h.createMetric(a.selector+"_DA","DA_day",{metric:[g]}),h.createMetric(a.selector+"_DA","DA_hour",{metric:[g]}),h.createMetric(a.selector+"_DA","DA_weekday",{metric:[g]}),h.createMetric(a.selector+"_DA","DA_week",{metric:[g]}),h.createMetric(a.selector+"_DA","DA_quarter",{metric:[g]}),console.timeEnd("metric"),E(a,"kokok",c,e)},E=function(a,b,c,d,e){var h={},i=(a.dateColumnName,a.aggregation),j={},k=[];if("string"==typeof c)g.year=f.Query.getData(a.selector+"_DA","DA_year"),g.month=f.Query.getData(a.selector+"_DA","DA_month"),g.day=f.Query.getData(a.selector+"_DA","DA_day"),g.hour=f.Query.getData(a.selector+"_DA","DA_hour"),g.weekday=f.Query.getData(a.selector+"_DA","DA_weekday"),g.week=f.Query.getData(a.selector+"_DA","DA_week"),g.quarter=f.Query.getData(a.selector+"_DA","DA_quarter");else if("object"==typeof c)f.Query.setQuery(a.selector+"_DA",c.seriesColumnName,{dimension:[c.seriesColumnName]}),g.year=f.Query.getData(a.selector+"_DA","DA_year",{filter:{column:"key",condition:"Equal",values:c.seriesName}}),g.month=f.Query.getData(a.selector+"_DA","DA_month",{filter:{column:"key",condition:"Equal",values:c.seriesName}}),g.day=f.Query.getData(a.selector+"_DA","DA_day",{filter:{column:"key",condition:"Equal",values:c.seriesName}}),g.hour=f.Query.getData(a.selector+"_DA","DA_hour",{filter:{column:"key",condition:"Equal",values:c.seriesName}}),g.weekday=f.Query.getData(a.selector+"_DA","DA_weekday",{filter:{column:"key",condition:"Equal",values:c.seriesName}}),g.week=f.Query.getData(a.selector+"_DA","DA_week",{filter:{column:"key",condition:"Equal",values:c.seriesName}}),g.quarter=f.Query.getData(a.selector+"_DA","DA_quarter",{filter:{column:"key",condition:"Equal",values:c.seriesName}});else{if("object"==typeof a.series_id)return j[b]=i,k=[j],h.year=f.Query.getData(a.selector,"DA_year",{filter:{column:"key",condition:"Equal",values:a.series_id.seriesName}}),h.month=f.Query.getData(a.selector,"DA_month",{filter:{column:"key",condition:"Equal",values:a.series_id.seriesName}}),h.day=f.Query.getData(a.selector,"DA_day",{filter:{column:"key",condition:"Equal",values:a.series_id.seriesName}}),h.hour=f.Query.getData(a.selector,"DA_hour",{filter:{column:"key",condition:"Equal",values:a.series_id.seriesName}}),h.weekday=f.Query.getData(a.selector,"DA_weekday",{filter:{column:"key",condition:"Equal",values:a.series_id.seriesName}}),h.week=f.Query.getData(a.selector,"DA_week",{filter:{column:"key",condition:"Equal",values:a.series_id.seriesName}}),h.quarter=f.Query.getData(a.selector,"DA_quarter",{filter:{column:"key",condition:"Equal",values:a.series_id.seriesName}}),h;if("string"==typeof a.series_id)return j[b]=i,k=[j],h.year=f.Query.getData(a.selector,"DA_year"),h.month=f.Query.getData(a.selector,"DA_month"),h.day=f.Query.getData(a.selector,"DA_day"),h.hour=f.Query.getData(a.selector,"DA_hour"),h.weekday=f.Query.getData(a.selector,"DA_weekday"),h.week=f.Query.getData(a.selector,"DA_week"),h.quarter=f.Query.getData(a.selector,"DA_quarter"),h}},F=function(a,b,c){var d,e=[];H(c);for(var f=0;f<l[c].length;f++){var g,h=[];switch(a){case"top":h.push(l[c][f][0].key),e.push(h);break;case"bottom":h.push(l[c][f].reverse()[0].key),e.push(h),l[c][f].reverse();break;case"topfew":g=Math.round(l[c][f].length/4),l[c][f].slice(0,g).map(function(a){return h.push(a.key),a}),e.push(h);break;case"bottomfew":g=Math.round(l[c][f].length/4),l[c][f].reverse().slice(0,g).map(function(a){return h.push(a.key),a}),l[c][f].reverse(),e.push(h)}d=c+"_dimension_"+j[f],d3.selectAll("#"+d+"_plot_group .column").style({fill:function(a,b){return e[f].indexOf(+this.getAttribute("granularity_value"))>-1?"orange":n}})}},G=function(a,b,e,j,p){var q,r,s,t,u,v=document.getElementById(j+"_dimensional_analysis_holder"),w=["Year","Quarter","Month","Week Number","Day","Weekday","Hour"],x=0,y=document.getElementById("dimensional_analysis_chart_tooltip"),B=parseInt(j.split("DA_panel_")[1]),C=document.getElementById(j),D=!1;for(l[j]=[],m.push(void 0),t=0,u=i.length;u>t;t++)r=i[t].granularity,g[r].length>1&&(x+=1);d3.selectAll(".dimension_filter").on("click",function(){event.stopPropagation()}).on("change",function(){d=m.slice();var a,b;if("none"!==this.value)for(a=1;k>a;a++)document.getElementById("DA_panel_"+a+"_dimensional_analysis_holder")&&(b=document.getElementById("DA_panel_"+a+"_reset_button"),b&&"visible"===b.style.visibility&&(b.style.visibility="hidden"),F(this.value,e,"DA_panel_"+a));else for(a=1;k>a;a++)document.getElementById("DA_panel_"+a+"_dimensional_analysis_holder")&&(b=document.getElementById("DA_panel_"+a+"_reset_button"),b&&"visible"===b.style.visibility&&(b.style.visibility="hidden"),H("DA_panel_"+a))}),C.setAttribute("data-chart",a),C.setAttribute("data-series",b);var E=j.split("DA_panel_")[1],G=z(a,b,j,E,"charts");for(document.querySelector("#"+j+" #suggestions_div")?document.querySelector("#"+j+" #suggestions_div").remove():document.querySelector("#"+j+" #panel_header_container")&&document.querySelector("#"+j+" #panel_header_container").remove(),document.querySelector("#"+j).insertBefore(G,document.getElementById(j+"_dimensional_analysis_holder")),t=0,u=i.length;u>t;t++){r=i[t].granularity,l[j].push(JSON.parse(JSON.stringify(g[r])));var I,K,L,P=document.createElement("div"),Q=JSON.parse(JSON.stringify(g[r])),R=j+"_dimension_"+r,S=[];f.chart_configs[R]={},f.chart_options[R]={},I=M(r,Q),K=I.func,D=!0,Q.sort(function(a,b){return a.key-b.key});for(var T=0,U=i[t].length||Q.length;U>T;T++)Q[T]||"year"===r?Q[T].key!==T+I.additionFactor&&"year"!==r&&(L={key:T+I.additionFactor,value:0},Q.splice(T,0,L)):Q[T]={key:T+I.additionFactor,value:0},Q[T].original_key=Q[T].key,Q[T].granularity=r,Q[T].key=K(Q[T].key),!I.xAxisTickInterval||T%I.xAxisTickInterval!==0&&T!==U-1?I.xAxisTickInterval||S.push(Q[T].key):S.push(Q[T].key);s=parseInt(document.getElementById(j).style.width),P.id=R,P.style["float"]="left",P.style.padding="3px",v.className="comcharts-TS-DA-column-charts-container",v.appendChild(P);var V=window.getComputedStyle(document.getElementById(j),null),W=document.getElementById(j).clientWidth-parseFloat(V.getPropertyValue("padding-left"))-parseFloat(V.getPropertyValue("padding-right")),X={width:f.isMobile?346:W,height:f.isMobile?246:100,data:Q,selector:R,chartType:"column",marginLeft:20,marginTop:30,marginRight:5,marginBottom:30,dateColumnName:"key",metricsColumnName:["value"],chartColor:[n],xAxisTickValues:S,xAxisTickValuesFormat:I.format,xAxisTickInterval:I.xAxisTickInterval,xAxisTickIntervalGranularity:I.xAxisTickIntervalGranularity,caption:w[t],showCaption:!0,captionFontWeight:"bold",captionFontSize:f.isMobile?17:12,captionAlign:"left",captionMargin:0,yAxisNoOfTicks:3,yAxisTickFormat:"s",yAxisLineOpacity:0,dimensionalAnalysisHighlightColor:e.dimensionalAnalysisHighlightColor,borderThickness:1,bordercolor:"white"};X=f.mediator.publish("validate",X,f["default"].chart_features),X=f.mediator.publish("validate",X,f["default"].chart_options),f.chart_options[X.selector]=X,f.mediator.publish("renderColumnChart",X),f.mediator.publish("columnChartOrdinal",X,Q,"DA"),f.mediator.publish("createColumnChart",X,Q,0),q=document.getElementById(R+"_overlay"),q.parentNode.removeChild(q),d3.selectAll("#"+R+"_plot_group .column").attr("granularity_value",function(a,b){return a.original_key}).attr("id",function(a,b){return"DA_"+a.original_key}).style("cursor","pointer").on("click",function(d,i){var l,q=0,r=this.parentNode.id.split("_")[2],s=d3.select("#"+this.parentNode.parentNode.parentNode.id)[0][0].offsetWidth,t=document.getElementById("DA_panel_"+B+"_reset_button");for(t&&t.parentNode.parentNode.removeChild(t.parentNode),d3.select("#"+this.parentNode.parentNode.parentNode.id).append("foreignObject").append("xhtml:span").attr({id:"DA_panel_"+B+"_reset_button"}).style({cursor:"pointer",position:"relative","margin-right":"5px",left:s-35+"px","font-size":"0.8em",color:"#5388ee",opacity:.8}).text("Reset").on("click",function(){d3.selectAll(".x-axis-selected-value").text(""),this.style.visibility="hidden",H("DA_panel_"+B);var a,b=0;for(a=1;k>a;a++)document.getElementById("DA_panel_"+a+"_reset_button")&&"visible"===document.getElementById("DA_panel_"+a+"_reset_button").style.visibility&&b++;b>1?document.getElementById("DA_reset_all_button").style.visibility="visible":document.getElementById("DA_reset_all_button").style.visibility="hidden",this.parentNode.parentNode.removeChild(this.parentNode)}),document.getElementById("DA_panel_"+r+"_reset_button").style.visibility="visible",l=1;k>l;l++)document.getElementById("DA_panel_"+l+"_reset_button")&&"visible"===document.getElementById("DA_panel_"+l+"_reset_button").style.visibility&&q++;k-1>1&&q>1&&document.getElementById("DA_reset_all_button")?document.getElementById("DA_reset_all_button").style.visibility="visible":document.getElementById("DA_reset_all_button")&&(document.getElementById("DA_reset_all_button").style.visibility="hidden"),d3.event.stopPropagation(),d3.selectAll("#"+j+"_dimensional_analysis_holder rect.column").style({fill:n,stroke:"white","stroke-dasharray":function(a,b){return"0,0"}}),O(j),d3.select(this).style({fill:o}),c=m[+r],m[+r]=d,N(d.granularity,d,e,j,b),J(a,b,e,m[+r],d,y,this,g,B);var u,v;for(v=2;4>=v;v++)if(document.querySelector("#DA_panel_"+v+" #suggestions_div")){u=v;break}if(u){var w=document.querySelector("#DA_panel_"+u+" #suggestions_div #compare_suggestion"),x=f.chart_options[document.getElementById("DA_panel_"+r).dataset.chart].caption||"Filter by time",z=document.getElementById("DA_panel_"+r).dataset,C=m[+r].granularity,D=m[+r].original_key;switch(z=z.series,C){case"month":D=f.dataManipulationFunctions.mmmm_array[D];break;case"hour":D++;break;case"weekday":D=f.dataManipulationFunctions.week_day_array[D]}var E,F=document.querySelector("#"+this.parentNode.parentNode.parentNode.id+" tspan").innerHTML;if(document.querySelector("#"+this.parentNode.parentNode.parentNode.id+" tspan.x-axis-selected-value")?(d3.selectAll(".x-axis-selected-value").text(""),E=d3.select("#"+this.parentNode.parentNode.parentNode.id+" tspan.x-axis-selected-value")):(E=d3.select("#"+this.parentNode.parentNode.parentNode.id+" text").append("tspan"),E.attr("class","x-axis-selected-value")),"Quarter"==F?E.text(" [Q"+D+"]"):E.text(" ["+D+"]"),document.querySelector("#DA_panel_"+u+" #"+x.replace(/ /g,"_")+"_"+z.replace(/ /g,"_")+"_suggestion"))document.querySelector("#DA_panel_"+u+" #"+x.replace(/ /g,"_")+"_"+z.replace(/ /g,"_")+"_suggestion #suggestion_desc").innerHTML="Do you want to compare how <b>"+z+"</b> of <b>"+x+"</b> in <b>"+h(C)+" "+D+"</b> performing against another <b>"+h(C)+"</b>?";else{if(c){var G=document.querySelector("#DA_panel_"+u+" #"+x.replace(/ /g,"_")+"_"+z.replace(/ /g,"_")+"_suggestion");G&&G.remove()}var I=document.createElement("span"),K=document.createElement("span");for(K.id="suggestion_desc",I.id=z.replace(/ /g,"_")+"_suggestion",I.className="suggestion_div",or_span=document.createElement("span"),or_span.className="or_span",or_span.innerHTML="<br><br>OR<br><br>",I.appendChild(or_span),K.innerHTML="Do you want to compare how <b>"+z+"</b> of <b>"+x+"</b> in <b>"+h(C)+" "+D+"</b> performing against another <b>"+h(C)+"</b>?",K.style.color="#5388ee",K.style.cursor="pointer",I.addEventListener("click",function(){var c,d=this.parentNode;for(v=+r;k>v;v++)if(document.querySelector("#DA_panel_"+v+" #suggestions_div")){c=v;break}if(c)for(var e=d.childNodes,f=0;f<e.length;f++)document.querySelector("#DA_panel_"+c+" #suggestions_div #compare_suggestion").appendChild(e[f]);A(a,b,a,u,p)}),I.appendChild(K);w.firstChild;)w.removeChild(w.firstChild);w.appendChild(I)}}}).on("mousemove",function(c,d){var f=this.parentNode.id.split("_")[2];J(a,b,e,m[+f],c,y,this,g,B)}).on("mouseover",function(c,f){var h,i=document.querySelector(".dimension_filter");if(h=this.parentNode.id.split("_")[2],J(a,b,e,m[+h],c,y,this,g,B),!m[+h]){if("none"!==i.options[i.selectedIndex].value){for(var l=1;k>l;l++)if(!m[l]&&(H("DA_panel_"+l),d[l])){var n=new Event("click");document.querySelector("#DA_panel_"+l+"_dimensional_analysis_holder #DA_"+d[l].original_key).dispatchEvent(n)}i.value="none"}m[+h]||(d3.event.stopPropagation(),d3.select(this).style({fill:o}),N(r,c,e,j,b),i.value="none"),d=[void 0]}}).on("mouseout",function(){var a=this.parentNode.id.split("_")[2];y.style.display="none",m[+a]||H(j)})}if(!D){var Y=document.createElement("span");Y.innerHTML="Lorem Ipsum is simply dummy text of the printing and typesetting industry.",document.querySelector("#"+j).appendChild(Y)}},H=function(a){d3.selectAll("#"+a+" rect.column").style({fill:n,stroke:"white","stroke-dasharray":function(a,b){return"0,0"}}),d3.selectAll("#"+a+" .comcharts-TS-highlight-column").attr({height:0});var b=a.split("DA_panel_")[1];if(m[+b]){var c,d=f.chart_options[document.getElementById("DA_panel_"+b).dataset.chart].caption||"Filter by time",e=document.getElementById("DA_panel_"+b).dataset.series;c=document.getElementById(d.replace(/ /g,"_")+"_"+e.replace(/ /g,"_")+"_suggestion"),c&&c.remove()}m[+b]=null},I=function(){var a=document.createElement("span");return a.id="DA_reset_all_button",a.className="modal-close",a.innerHTML="Reset all",a.addEventListener("click",function(){this.style.visibility="hidden";for(var a=1;k>a;a++)document.getElementById("DA_panel_"+a+"_reset_button")&&(document.getElementById("DA_panel_"+a+"_reset_button").style.visibility="hidden"),H("DA_panel_"+a)}),a},J=function(a,b,c,d,e,g,h,i,j){var k,l,m=K(a,b,c,i,d,e,j);f.mediator.publish("renderTooltipContent","dimensional_analysis_chart_tooltip",m),g.style.display="block",k=d3.event.pageX+15,l=d3.event.pageY-15,g.style.top=l+"px",g.style.left=k+"px"},K=function(a,c,d,e,f,g,h){var i,j,k,l,m,p,q,r,s,t,u,v,w=g.granularity,x=0,y=d.outputNumberFormat,z=d3.format(y),A=["year","quarter","month","week","day","weekday","hour"];s=M(w,e),l=L(w,e),m=l(s.func(g.original_key),g.original_key),f?(i=f.granularity,s=M(i,e),l=L(i,e),p=l(s.func(f.original_key),f.original_key),j=f.granularity===w?e[w]:b[w]):j=e[w];for(var B=0,C=j.length;C>B;B++)x+=j[B].value,g.original_key===j[B].key&&(t=j[B].value);return k=(t/x*100).toFixed(2),f&&f.granularity!==w?(A.indexOf(i)>A.indexOf(w)?(u=p,v=m):(u=m,v=p),r="<table class='hovered_clicked_granularity_uneq'><tr class='first_row'><td><span>"+m+"</span> contributes</td><tr>",r+="<tr class='second_row'><td>"+z(t)+" ("+k+"%)</td><tr>",r+="<tr class='third_row'><td>to the total <b>"+c+"</b></td><tr>",r+="<tr class='fourth_row'><td><span class='first_span'>"+z(x)+"</span> in <span class='second_span'>"+p+"</span></td><tr></table>"):(q=n,f&&f.original_key!==g.original_key||(q=o),r="<table class='hovered_clicked_granularity_eq'><tr class='first_row'><td><span>"+m+"</span> contributes</td></tr>",r+="<tr class='second_row'><td style='color:"+q+";'>"+z(t)+" ("+k+"%)</td></tr>",r+="<tr class='third_row'><td>to the total <b>"+c+"</b></td></tr>",r+="<tr class='fourth_row'><td><span class='first_span'>"+z(x)+"</span> across all the <span class='second_span'>"+w+"s</span></td></tr></table>"),r},L=function(a,b){switch(a){case"month":return d3.time.format("%B");case"weekday":return d3.time.format("%A");case"quarter":var c=["Quarter 1","Quarter 2","Quarter 3","Quarter 4"],d=function(a,b){return c[b-1]};return d;case"week":return function(a,b){return"Week "+b};case"hour":return function(a,b){return"Hour "+b};case"day":return function(a,b){return"Day "+b};default:return d3.time.format(M(a,b).format)}},M=function(a,b){var c={};switch(a){case"year":var d=4;return b.length<4&&(d=b.length),c={func:function(a){return new Date(a,0)},format:"%Y",xAxisTickInterval:d};case"month":return c={func:function(a){return new Date((new Date).getFullYear(),a)},format:"%b",xAxisTickInterval:4,additionFactor:0};case"hour":return c={func:function(a){var b=new Date((new Date).getFullYear()+"/01/01").setHours(a);return new Date(b)},format:"%H",xAxisTickInterval:4,additionFactor:0};case"weekday":return c={func:function(a){var b,c;return b=new Date("1/1/2014"),c=a,currentDay=b.getDay(),distance=c-currentDay,b.setDate(b.getDate()+distance),new Date(b)},format:"%a",xAxisTickInterval:2,additionFactor:0};case"week":return c={func:function(a){var b=2012,c=a,d=new Date(b,0,1),e=d.getTimezoneOffset();return d.setDate(d.getDate()+4-(d.getDay()||7)),d.setTime(d.getTime()+6048e5*(c+(b==d.getFullYear()?-1:0))),d.setTime(d.getTime()+60*(d.getTimezoneOffset()-e)*1e3),d.setDate(d.getDate()-3),d},format:"%U",xAxisTickInterval:26,additionFactor:1};case"quarter":var e=["Q1","Q2","Q3","Q4"];return c={func:function(a){var b=[new Date("1/1/2000"),new Date("4/1/2000"),new Date("7/1/2000"),new Date("10/1/2000")];return b[a-1]},format:function(a,b){return e[b]},xAxisTickInterval:0,additionFactor:1};case"day":return c={func:function(a){return new Date("1/"+a+"/2014")},format:"%d",xAxisTickInterval:3,additionFactor:1}}},N=function(c,d,e,g,h){var k,l,m,n={year:null,month:null,hour:null,day:null,week:null,weekday:null,quarter:null},o=e.selector+"_DA";switch(d.granularity){case"year":c="%Y";break;case"month":c="%m";break;case"hour":c="%H";break;case"day":c="%d";break;case"weekday":c="%w";break;case"week":c="%U";break;case"quarter":c="%m"}n[d.granularity]=[d.original_key,d.original_key],console.time("filter time"),s(n,{selector:o}),b=E({selector:o,granularity:c,aggregation:"sum",dateColumnName:e.dateColumnName,series_id:h},a);for(var p in b)if(p!==d.granularity&&f.chart_options[g+"_dimension_"+p]){b[p].sort(function(a,b){return a.key-b.key}),l=JSON.parse(JSON.stringify(b[p])),m=M(p,d),k=m.func;for(var q,r=0,t=i[j.indexOf(p)].length||l.length;t>r;r++)l[r]||"year"===p?l[r].key!==r+m.additionFactor&&"year"!==p&&(q={key:r+m.additionFactor,value:0},l.splice(r,0,q)):l[r]={key:r+m.additionFactor,value:0},l[r].key=k(l[r].key);P(f.chart_options[g+"_dimension_"+p],l),d3.selectAll("#"+(g+"_dimension_"+p)+"_plot_group rect.column").style("fill",function(a,b){return"#ECECEC"})}},O=function(a){d3.selectAll("#"+a+"_dimensional_analysis_holder .comcharts-TS-highlight-column").attr("height",0)},P=function(a,b,c){var d,e=d3.select("#"+a.selector+"_plot_group"),g=f.chart_configs[a.selector],h=g.fakeOrdinanalScale,i=g.height,j=(g.width,f.xAxisFunctions,f.yAxisFunctions,d3.select("#"+a.selector+"_svg_group #xaxis"),d3.select("#"+a.selector+"_svg_group #yaxis"),g.yScale);d=e.selectAll(".comcharts-TS-highlight-column").data(b),d.enter().append("rect").attr("class","comcharts-TS-highlight-column").style("pointer-events","none"),d.style({fill:a.chartColor[0],"stroke-width":a.borderThickness,stroke:a.bordercolor}).attr({x:function(a){return h(new Date(a.key))},width:h.rangeBand(),y:function(a){return a.value?j(0===c?0:a.value):0},height:function(a){return a.value?i-j(0===c?0:a.value):0}}),d.exit().remove()},Q=function(a,b,c,d){var e,g,h=document.createElement("div"),i=a.split("DA_panel_")[1];if(g=document.createElement("span"),g.className="comcharts-TS-DA-analyze-series",b?g.innerHTML="Analyze a series":g.innerHTML="Analyze another series",h.id="suggestions_div",h.className="suggestions_div",h.appendChild(g),e=R(a,c),g.style.cursor="pointer",g.addEventListener("click",function(){f.mediator.publish("initModal",{content:e,modal_title:'Select a series to "Roll-up by time"',close_text:"x",close_id:"DA_close_select_series",modal_type:"custom",selected_tab:"DA_panel_"+i,maxHeight:"65%",top:"20%"})}),1==i&&b&&f.mediator.publish("initModal",{content:e,modal_title:'Select a series to "Roll-up by time"',close_text:"x",close_id:"DA_close_select_series",modal_type:"custom",selected_tab:"DA_panel_1",maxHeight:"65%",top:"20%"}),document.querySelector(".scotch-modal")){var j=document.querySelector(".scotch-modal").offsetHeight-document.querySelector(".comcharts-TS-modal-chartarea-title").offsetHeight-document.querySelector(".comcharts-TS-help").offsetHeight-50;d3.selectAll(".comcharts-TS-DA-modal-selection-list-box").style("height",j+"px")}g=document.createElement("span"),g.id="compare_suggestion",h.appendChild(g),document.getElementById(a).appendChild(h)},R=function(a,b){var c,d=document.createElement("div"),e=document.createElement("ul"),g=document.createElement("div"),h=a.split("DA_panel_")[1],i=document.createElement("div"),j=(document.createElement("div"),document.createElement("div"),document.createElement("div"));d.className="comcharts-TS-sidebar comcharts-TS-DA-modal-container",d.style.width="100%";var k=document.createElement("div");k.className="comcharts-TS-help",k.innerHTML="Roll-up by time gives you histograms by various units of time e.g. year, quarter, month, week number, day of the week, etc. These pre-built visual histograms allow you to explore interesting insights about each series, visually determine contributions and compare each series against another.",d.appendChild(k);for(var l=f.chart_options[b],m=l.metricsColumnName,n=l.newMetricsColumn,o=l.displayMetricsColumn,p=m.length,q=0;p>q;q++)series_options=document.createElement("li"),series_options.className="comcharts-TS-sub-category-feature-modal",series_options.dataset.value=n[q],series_options.innerHTML=o[q],series_options.dataset.chart=b,e.appendChild(series_options);return j.className="suggestions-div-title",c=document.createElement("span"),c.className="comcharts-TS-content-sub-heading comcharts-TS-suggestions-div-select-dashboard",c.innerHTML="Series",j.appendChild(c),e.id="panel_DA_series_"+h+"_select_box",e.setAttribute("panel-id",h),e.className="comcharts-TS-sidebar-ul comcharts-TS-card-effect",e.onfocus=function(){this.options[0].style.display="none"},e.onblur=function(){this.options[0].style.display="block"},g.className="comcharts-TS-DA-modal-selection-list-box thick comcharts-background-lightgray",g.id="comcharts_TS_DA_modal_series_selection",g.style.width="100%",g.appendChild(j),g.appendChild(e),e.addEventListener("click",function(){var a,b=document.querySelector(".dimension_filter"),c=b.options[b.selectedIndex].value,d=event.srcElement.dataset.chart,e=event.srcElement.dataset;event.srcElement.innerHTML;a=e.value,d3.selectAll("#panel_DA_series_"+h+"_select_box li").classed("active",!1),d3.select(event.srcElement).classed("active",!0),A(d,a,d,h,e),f.mediator.publish("closeModal"),"none"!==c&&F(c,options,"DA_panel_"+this.getAttribute("panel-id"))}),d.appendChild(g),i.appendChild(d),i},S=function(a,b){var c,d=document.createElement("div"),e=document.createElement("div"),f=(document.createElement("div"),document.createElement("div"),document.createElement("div"),document.createElement("div"),document.createElement("div"));d.id="dimensionalAnalysis",d.innerHTML='<div class="col-sm-12 comcharts-TS-content-sub-heading" style="padding:0px;"><div id="DA_highlight_view" class="col-sm-12 comcharts-TS-da-tab" style="border:none;"></div></div>',e.id="DA_panel_1",e.className="col-sm-4 comcharts-TS-da-tab",f.id="comchart_TS_clearfix",f.className="comcharts-TS-clearfix",d.appendChild(e),d.appendChild(f),document.querySelector("#"+a).appendChild(d);var g=document.createElement("div");g.className="comcharts-TS-help",g.id="roll_up_help_text",g.innerHTML="Roll-up by time gives you histograms by various units of time e.g. year, quarter, month, week number, day of the week, etc. These pre-built visual histograms allow you to explore interesting insights about each series, visually determine contributions and compare each series against another.",document.getElementById("roll_up_help_text")||document.querySelector("#"+a).appendChild(g),c=document.getElementById("DA_highlight_view"),c.innerHTML="<span class='comcharts-TS-da-chart-name comcharts-TS-da-drop-down-title'>Highlight</span>",create_selectbox=document.createElement("select"),create_selectbox.setAttribute("class","dimension_filter"),option_value=["none","top","bottom","topfew","bottomfew"],option_text=["None","Top","Bottom","Top Few","Last Few"],len=option_value.length,create_selectbox.id="_DA_agg",create_selectbox.setAttribute("parent_id","div");for(var h=0;h<len;h++)option=document.createElement("option"),option.value=option_value[h],option.text=option_text[h],create_selectbox.appendChild(option);c.appendChild(create_selectbox),document.getElementById("_DA_agg")||user_div.appendChild(c),Q("DA_panel_1",!0,b,"Surface Pressure")};return f.mediator.subscribe("configureDimensionalAnalysis",t),f.mediator.subscribe("initDimensionalAnalysis",y),f.mediator.subscribe("createDimensionData",D),f.mediator.subscribe("createDimensionCharts",G),f.mediator.subscribe("createColumnChart",P),f.mediator.subscribe("seeDimensionalAnalysis",B),f.mediator.subscribe("updateDimensionalAnalysis",C),f.mediator.subscribe("createOverlay",v),f.mediator.subscribe("dimensionalAnalysisConfigCallback",u),f.mediator.subscribe("createOverlay",v),f.mediator.subscribe("queryInitializer",w),f.mediator.subscribe("executeOnComplete",x),{init:y,createData:D,createCharts:G,mapFunction:M,createOverlay:v}}();var i=!1;!function(a){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(i=!0)}(navigator.userAgent||navigator.vendor||window.opera),f.isMobile=i,console.log("isMobile",f.isMobile),i=!1,function(a){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|pprox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(i=!0)}(navigator.userAgent||navigator.vendor||window.opera),f.isMobileOrTablet=i,console.log("isMobileOrTablet",f.isMobileOrTablet);var j=function(a,b){f.mediator.publish("createChart",a,b)},k=function(a,b){var c,d,e=0,g=1,h={1:{data:a.data,dataFormat:a.dataFormat,dataSource:a.dataSource,dataFor:[a.selector],dataName:a.dataName,dataDescription:a.dataDescription}};f.global_data_sets=h,f.data_load_status[g]={status:!1,onComplete:[]},c=h[g].dataFor,d=c.length,f.chart_options[c[e]]={},f.chart_options[c[e]].data=g,f.gChart_to_data_set_mapping[c[e]]=f.gChart_to_data_set_mapping[c[e]]||[],f.gChart_to_data_set_mapping[c[e]].push(g),f.data_aliases[c[e]]=f.data_aliases[c[e]]||{alias:{}},f.data_aliases[c[e]].alias=f.mediator.publish("extendDefaults",f.data_aliases[c[e]].alias,f.global_data_sets[g].alias);var i=a.selector;/*!options.data && */
return f.chart_status[i]={status:!1,onComplete:[]},f.status_for_menu_bar=f.status_for_menu_bar||{on_load_count:0,on_complete_count:0,onComplete:[]},f.status_for_menu_bar.on_load_count+=1,f.allCharts.push(a.selector),f.chart_options[i]&&(a.data=f.chart_options[i].data,a.isGlobalData=!0,f.gData_set_to_chart_mapping[a.data]=f.gData_set_to_chart_mapping[a.data]||[],f.gData_set_to_chart_mapping[a.data].push(i),"completed"!==f.data_load_status[a.data].status)?(f.data_load_status[a.data].onComplete.push({function_name:"configureDimensionalAnalysis",attribute:[a]}),f.data_load_status[a.data].onComplete.push({function_name:"initDimensionalAnalysis",attribute:[a,b]}),void f.mediator.publish("parseGlobalData",h[g].data,"executeOnComplete",g)):void 0};return f.mediator.subscribe("createChart",k),{seeDimensionalAnalysis:j,createChart:k,get assets(){return f.assets},set assets(a){f.validation.dataTypes(a,"string")?f.assets=a:f.assets="/"},TimeSeries:f}}();